import{r as p,x as $,j as e,t as I}from"./app-Aw6YSH6g.js";import{B as R}from"./badge-CIMVAU4m.js";import{B as c}from"./createLucideIcon-D6F2HjNJ.js";import{C as h,a as j,b as g,d as f,c as v}from"./card-Bb0v4BpC.js";import{I as d}from"./input-DDWDjiWn.js";import{L as l}from"./label-BHrV2oJA.js";import{S as K,a as O,b as z,c as V,d as P}from"./select-Btd99lWl.js";import{T as _}from"./textarea-D6TmZ_G-.js";import{S as G}from"./sales-layout-Ua4EjijN.js";import{A as H}from"./arrow-left-KDZHKcbm.js";import{T as U}from"./target-CxryD2I-.js";import{M as T}from"./map-pin-NmMPXV0O.js";import{R as q}from"./rotate-ccw-DCs99wP3.js";import{S as J}from"./save-2VQpg1TB.js";import"./index-CS0-MCoE.js";import"./index-hDe8CdPJ.js";import"./index-COA2UNkf.js";import"./index-BMgGVTnd.js";import"./index-BfqNDOgH.js";import"./index-4OnYSvy0.js";import"./chevron-down-XTd1Aqfr.js";import"./breadcrumbs-qVQ5pWbj.js";import"./app-logo-Crmkh7xx.js";import"./index-CBCVPOvL.js";import"./index-BaexZHHE.js";import"./index-C1N_NOKC.js";import"./chevron-right-DlF4IjTy.js";import"./chart-column-D3ayj0F1.js";import"./square-check-big-oINFdxmX.js";function ye({categories:m}){const[u,A]=p.useState(null),[y,o]=p.useState(""),[b,k]=p.useState(!1),[E,S]=p.useState(""),{data:t,setData:r,post:D,processing:C,errors:a}=$({prospect_category_id:"",customer_name:"",customer_email:"",customer_number:"",address:"",sales_location:"",latitude:"",longitude:"",notes:""}),F=s=>{s.preventDefault(),D("/sales/prospects")},L=()=>{if(!navigator.geolocation){o("Geolocation tidak didukung oleh browser ini.");return}k(!0),o(""),navigator.geolocation.getCurrentPosition(async s=>{const{latitude:i,longitude:n}=s.coords;A({lat:i,lng:n});try{const x=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${i}&lon=${n}`)).json()).display_name||`${i}, ${n}`;S(x),r(M=>({...M,latitude:i.toString(),longitude:n.toString(),sales_location:x}))}catch(w){console.error("Error getting address:",w);const N=`${i}, ${n}`;S(N),r(x=>({...x,latitude:i.toString(),longitude:n.toString(),sales_location:N}))}k(!1)},s=>{switch(k(!1),s.code){case s.PERMISSION_DENIED:o("Izin lokasi ditolak. Silakan aktifkan GPS dan izin lokasi.");break;case s.POSITION_UNAVAILABLE:o("Informasi lokasi tidak tersedia.");break;case s.TIMEOUT:o("Permintaan lokasi timeout.");break;default:o("Terjadi kesalahan saat mengambil lokasi.");break}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},B=()=>{L()};return e.jsx(G,{breadcrumbs:[{title:"Dashboard",href:"/sales"},{title:"Prospek",href:"/sales/prospects"},{title:"Tambah Prospek",href:"/sales/prospects/create"}],children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(I,{href:"/sales/prospects",children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Tambah Prospek Baru"}),e.jsx("p",{className:"text-muted-foreground",children:"Inputkan data prospek customer untuk mendapat poin"})]})]}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5"}),"Kategori Prospek"]}),e.jsx(f,{children:"Pilih kategori sesuai dengan jenis customer"})]}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"prospect_category_id",children:"Kategori *"}),e.jsxs(K,{value:t.prospect_category_id,onValueChange:s=>r("prospect_category_id",s),children:[e.jsx(O,{children:e.jsx(z,{placeholder:"Pilih kategori prospek"})}),e.jsx(V,{children:m&&m.length>0?m.map(s=>e.jsx(P,{value:s.id.toString(),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("span",{children:s.name}),e.jsxs(R,{variant:"secondary",className:"ml-2",children:[s.points," poin"]})]})},s.id)):e.jsx(P,{value:"no-categories",disabled:!0,children:"Tidak ada kategori tersedia"})})]}),a.prospect_category_id&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.prospect_category_id})]}),t.prospect_category_id&&e.jsx("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:(()=>{const s=m.find(i=>i.id.toString()===t.prospect_category_id);return s?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-primary",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsxs("p",{className:"mt-1 text-sm font-medium",children:["Poin yang didapat: ",s.points]})]}):null})()})]})})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Informasi Customer"}),e.jsx(f,{children:"Data kontak dan informasi customer"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"customer_name",children:"Nama Customer *"}),e.jsx(d,{id:"customer_name",type:"text",value:t.customer_name,onChange:s=>r("customer_name",s.target.value),placeholder:"Masukkan nama lengkap customer"}),a.customer_name&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.customer_name})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"customer_email",children:"Email"}),e.jsx(d,{id:"customer_email",type:"email",value:t.customer_email,onChange:s=>r("customer_email",s.target.value),placeholder:"customer@email.com"}),a.customer_email&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.customer_email})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"customer_number",children:"Nomor Telepon"}),e.jsx(d,{id:"customer_number",type:"tel",value:t.customer_number,onChange:s=>r("customer_number",s.target.value),placeholder:"08xxxxxxxxxx"}),a.customer_number&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.customer_number})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"address",children:"Alamat"}),e.jsx(_,{id:"address",value:t.address,onChange:s=>r("address",s.target.value),placeholder:"Alamat lengkap customer",rows:3}),a.address&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.address})]})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Lokasi Sales & Koordinat"]}),e.jsx(f,{children:"Ambil lokasi sales saat ini dan koordinat untuk pemetaan"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row",children:[e.jsxs(c,{type:"button",variant:"outline",onClick:L,disabled:b,className:"w-full sm:w-auto",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),b?"Mengambil Lokasi...":"Ambil Lokasi Saat Ini"]}),u&&e.jsxs(c,{type:"button",variant:"outline",onClick:B,disabled:b,className:"w-full sm:w-auto",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Refresh Lokasi"]})]}),y&&e.jsx("div",{className:"rounded-lg border border-destructive/20 bg-destructive/10 p-3",children:e.jsx("p",{className:"text-sm text-destructive",children:y})}),E&&e.jsxs("div",{children:[e.jsx(l,{htmlFor:"sales_location",children:"Lokasi Sales Saat Ini"}),e.jsx(_,{id:"sales_location",value:t.sales_location,onChange:s=>r("sales_location",s.target.value),placeholder:"Lokasi sales akan terisi otomatis...",rows:3,className:"mt-1"}),a.sales_location&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.sales_location})]}),u&&e.jsxs("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:[e.jsx("p",{className:"mb-1 text-sm font-medium text-primary",children:"Koordinat Berhasil Diambil"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Latitude: ",u.lat.toFixed(6),", Longitude: ",u.lng.toFixed(6)]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"latitude",children:"Latitude"}),e.jsx(d,{id:"latitude",type:"number",step:"any",value:t.latitude,onChange:s=>r("latitude",s.target.value),placeholder:"-6.200000"}),a.latitude&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.latitude})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"longitude",children:"Longitude"}),e.jsx(d,{id:"longitude",type:"number",step:"any",value:t.longitude,onChange:s=>r("longitude",s.target.value),placeholder:"106.816666"}),a.longitude&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.longitude})]})]})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Catatan"}),e.jsx(f,{children:"Informasi tambahan tentang prospek ini"})]}),e.jsxs(v,{children:[e.jsx(_,{value:t.notes,onChange:s=>r("notes",s.target.value),placeholder:"Catatan tambahan tentang prospek, kebutuhan, atau informasi penting lainnya...",rows:4}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.notes})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row",children:[e.jsxs(c,{type:"submit",disabled:C,className:"flex-1 sm:flex-none",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),C?"Menyimpan...":"Simpan Prospek"]}),e.jsx(c,{variant:"outline",asChild:!0,className:"flex-1 sm:flex-none",children:e.jsx(I,{href:"/sales/prospects",children:"Batal"})})]})]})]})})}export{ye as default};
