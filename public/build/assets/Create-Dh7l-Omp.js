import{r as p,x as $,j as e,t as I}from"./app-BLez37KC.js";import{B as R}from"./badge-D4xRpmmj.js";import{a as K,B as c}from"./createLucideIcon-D7jF-U3a.js";import{C as h,a as j,b as g,d as f,c as v}from"./card-DPL22DDR.js";import{I as d}from"./input-CfqiYqKE.js";import{L as o}from"./label-DodKdBUJ.js";import{S as O,a as z,b as V,c as G,d as P}from"./select-DacCT32A.js";import{T as _}from"./textarea-DQevsQuX.js";import{S as H}from"./sales-layout-C_OT4tUC.js";import{A as U}from"./arrow-left-WkflEVvo.js";import{T as q}from"./target-CeMBhz-L.js";import{M as T}from"./map-pin-CCt7VWHT.js";import{S as J}from"./save-BHXHfQsR.js";import"./index-CUGJ33FR.js";import"./index-DACyNOe1.js";import"./index-BM8vqouP.js";import"./index-C8WjSdCF.js";import"./index-DCLdOoa8.js";import"./index-CudrPBro.js";import"./chevron-down-Owv8Hoe3.js";import"./breadcrumbs-TaC7mxAV.js";import"./app-logo-D_aXoxBq.js";import"./index-S0T8KroD.js";import"./index-DWyXbAj6.js";import"./index-CnGiqB3I.js";import"./chevron-right-Ci9N-8KN.js";import"./chart-column-B0kV8gCq.js";import"./square-check-big-NAs-teq6.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],W=K("RotateCcw",Q);function Se({categories:m}){const[u,A]=p.useState(null),[y,l]=p.useState(""),[k,b]=p.useState(!1),[E,S]=p.useState(""),{data:t,setData:r,post:D,processing:C,errors:a}=$({prospect_category_id:"",customer_name:"",customer_email:"",customer_number:"",address:"",sales_location:"",latitude:"",longitude:"",notes:""}),F=s=>{s.preventDefault(),D("/sales/prospects")},L=()=>{if(!navigator.geolocation){l("Geolocation tidak didukung oleh browser ini.");return}b(!0),l(""),navigator.geolocation.getCurrentPosition(async s=>{const{latitude:i,longitude:n}=s.coords;A({lat:i,lng:n});try{const x=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${i}&lon=${n}`)).json()).display_name||`${i}, ${n}`;S(x),r(B=>({...B,latitude:i.toString(),longitude:n.toString(),sales_location:x}))}catch(w){console.error("Error getting address:",w);const N=`${i}, ${n}`;S(N),r(x=>({...x,latitude:i.toString(),longitude:n.toString(),sales_location:N}))}b(!1)},s=>{switch(b(!1),s.code){case s.PERMISSION_DENIED:l("Izin lokasi ditolak. Silakan aktifkan GPS dan izin lokasi.");break;case s.POSITION_UNAVAILABLE:l("Informasi lokasi tidak tersedia.");break;case s.TIMEOUT:l("Permintaan lokasi timeout.");break;default:l("Terjadi kesalahan saat mengambil lokasi.");break}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},M=()=>{L()};return e.jsx(H,{breadcrumbs:[{title:"Dashboard",href:"/sales"},{title:"Prospek",href:"/sales/prospects"},{title:"Tambah Prospek",href:"/sales/prospects/create"}],children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(c,{variant:"ghost",size:"sm",asChild:!0,children:e.jsx(I,{href:"/sales/prospects",children:e.jsx(U,{className:"h-4 w-4"})})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Tambah Prospek Baru"}),e.jsx("p",{className:"text-muted-foreground",children:"Inputkan data prospek customer untuk mendapat poin"})]})]}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Kategori Prospek"]}),e.jsx(f,{children:"Pilih kategori sesuai dengan jenis customer"})]}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"prospect_category_id",children:"Kategori *"}),e.jsxs(O,{value:t.prospect_category_id,onValueChange:s=>r("prospect_category_id",s),children:[e.jsx(z,{children:e.jsx(V,{placeholder:"Pilih kategori prospek"})}),e.jsx(G,{children:m&&m.length>0?m.map(s=>e.jsx(P,{value:s.id.toString(),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("span",{children:s.name}),e.jsxs(R,{variant:"secondary",className:"ml-2",children:[s.points," poin"]})]})},s.id)):e.jsx(P,{value:"no-categories",disabled:!0,children:"Tidak ada kategori tersedia"})})]}),a.prospect_category_id&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.prospect_category_id})]}),t.prospect_category_id&&e.jsx("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:(()=>{const s=m.find(i=>i.id.toString()===t.prospect_category_id);return s?e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-primary",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description}),e.jsxs("p",{className:"mt-1 text-sm font-medium",children:["Poin yang didapat: ",s.points]})]}):null})()})]})})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Informasi Customer"}),e.jsx(f,{children:"Data kontak dan informasi customer"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"customer_name",children:"Nama Customer *"}),e.jsx(d,{id:"customer_name",type:"text",value:t.customer_name,onChange:s=>r("customer_name",s.target.value),placeholder:"Masukkan nama lengkap customer"}),a.customer_name&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.customer_name})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"customer_email",children:"Email"}),e.jsx(d,{id:"customer_email",type:"email",value:t.customer_email,onChange:s=>r("customer_email",s.target.value),placeholder:"customer@email.com"}),a.customer_email&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.customer_email})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"customer_number",children:"Nomor Telepon"}),e.jsx(d,{id:"customer_number",type:"tel",value:t.customer_number,onChange:s=>r("customer_number",s.target.value),placeholder:"08xxxxxxxxxx"}),a.customer_number&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.customer_number})]})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"address",children:"Alamat"}),e.jsx(_,{id:"address",value:t.address,onChange:s=>r("address",s.target.value),placeholder:"Alamat lengkap customer",rows:3}),a.address&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.address})]})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(g,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"h-5 w-5"}),"Lokasi Sales & Koordinat"]}),e.jsx(f,{children:"Ambil lokasi sales saat ini dan koordinat untuk pemetaan"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row",children:[e.jsxs(c,{type:"button",variant:"outline",onClick:L,disabled:k,className:"w-full sm:w-auto",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),k?"Mengambil Lokasi...":"Ambil Lokasi Saat Ini"]}),u&&e.jsxs(c,{type:"button",variant:"outline",onClick:M,disabled:k,className:"w-full sm:w-auto",children:[e.jsx(W,{className:"mr-2 h-4 w-4"}),"Refresh Lokasi"]})]}),y&&e.jsx("div",{className:"rounded-lg border border-destructive/20 bg-destructive/10 p-3",children:e.jsx("p",{className:"text-sm text-destructive",children:y})}),E&&e.jsxs("div",{children:[e.jsx(o,{htmlFor:"sales_location",children:"Lokasi Sales Saat Ini"}),e.jsx(_,{id:"sales_location",value:t.sales_location,onChange:s=>r("sales_location",s.target.value),placeholder:"Lokasi sales akan terisi otomatis...",rows:3,className:"mt-1"}),a.sales_location&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.sales_location})]}),u&&e.jsxs("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:[e.jsx("p",{className:"mb-1 text-sm font-medium text-primary",children:"Koordinat Berhasil Diambil"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Latitude: ",u.lat.toFixed(6),", Longitude: ",u.lng.toFixed(6)]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx(o,{htmlFor:"latitude",children:"Latitude"}),e.jsx(d,{id:"latitude",type:"number",step:"any",value:t.latitude,onChange:s=>r("latitude",s.target.value),placeholder:"-6.200000"}),a.latitude&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.latitude})]}),e.jsxs("div",{children:[e.jsx(o,{htmlFor:"longitude",children:"Longitude"}),e.jsx(d,{id:"longitude",type:"number",step:"any",value:t.longitude,onChange:s=>r("longitude",s.target.value),placeholder:"106.816666"}),a.longitude&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.longitude})]})]})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(g,{children:"Catatan"}),e.jsx(f,{children:"Informasi tambahan tentang prospek ini"})]}),e.jsxs(v,{children:[e.jsx(_,{value:t.notes,onChange:s=>r("notes",s.target.value),placeholder:"Catatan tambahan tentang prospek, kebutuhan, atau informasi penting lainnya...",rows:4}),a.notes&&e.jsx("p",{className:"mt-1 text-sm text-destructive",children:a.notes})]})]}),e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row",children:[e.jsxs(c,{type:"submit",disabled:C,className:"flex-1 sm:flex-none",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),C?"Menyimpan...":"Simpan Prospek"]}),e.jsx(c,{variant:"outline",asChild:!0,className:"flex-1 sm:flex-none",children:e.jsx(I,{href:"/sales/prospects",children:"Batal"})})]})]})]})})}export{Se as default};
