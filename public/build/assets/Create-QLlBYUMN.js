import{r as u,x as $,j as e,t as P}from"./app-Ci8v6MrU.js";import{B as R}from"./badge-BIBJLQYD.js";import{B as n}from"./createLucideIcon-D00yv57C.js";import{C as h,a as j,b as g,d as N,c as b}from"./card-ByE5s6QK.js";import{I as c}from"./input-DnuT7wtE.js";import{L as i}from"./label-CkP74dud.js";import{S as K,a as O,b as q,c as V,d as I}from"./select-D2c9BwBa.js";import{T as k}from"./textarea-Dx5n78-a.js";import{S as G}from"./sales-layout-BJODZQ17.js";import{A as H}from"./arrow-left-BWbC2ioP.js";import{T as U}from"./target-Cx7wIY1u.js";import{M as T}from"./map-pin-BgkYQV3V.js";import{R as J}from"./rotate-ccw-BAsgF1vf.js";import{S as Q}from"./save-CbUNuIkE.js";import"./index-DDGoCjQ0.js";import"./index-de0Lxc7d.js";import"./index-CjJcgxXh.js";import"./index-Rg3zaoIu.js";import"./index-SNZ2oUW7.js";import"./index-STlN5Ses.js";import"./chevron-down-Du86AyeO.js";import"./chevron-up-BUsFiYjA.js";import"./breadcrumbs-dv4TgKDm.js";import"./app-logo-B3Gf4bRh.js";import"./index-CWMKBz9E.js";import"./index-cyYLnq4n.js";import"./index-CBB6N_tQ.js";import"./chevron-right-CupTmoq7.js";import"./chart-column-DQ7dRjy4.js";import"./square-check-big-B3C6CO0m.js";function Se({categories:x}){const A="@keyframes softPulse { 0% { opacity: 1; transform: scale(1); } 30% { opacity: 0.9; transform: scale(1.02); } 100% { opacity: 1; transform: scale(1); } } .animate-soft-pulse { animation: softPulse 1s infinite; }",[o,E]=u.useState(null),[_,m]=u.useState(""),[f,v]=u.useState(!1),[D,w]=u.useState(""),{data:t,setData:r,post:F,processing:S,errors:a}=$({prospect_category_id:"",customer_name:"",customer_email:"",customer_number:"",address:"",sales_location:"",latitude:"",longitude:"",notes:""}),B=s=>{s.preventDefault(),F("/sales/prospects")},C=()=>{if(!navigator.geolocation){m("Geolocation tidak didukung oleh browser ini.");return}v(!0),m(""),navigator.geolocation.getCurrentPosition(async s=>{const{latitude:l,longitude:d}=s.coords;E({lat:l,lng:d});try{const p=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${l}&lon=${d}`)).json()).display_name||`${l}, ${d}`;w(p),r(M=>({...M,latitude:l.toString(),longitude:d.toString(),sales_location:p}))}catch(L){console.error("Error getting address:",L);const y=`${l}, ${d}`;w(y),r(p=>({...p,latitude:l.toString(),longitude:d.toString(),sales_location:y}))}v(!1)},s=>{switch(v(!1),s.code){case s.PERMISSION_DENIED:m("Izin lokasi ditolak. Silakan aktifkan GPS dan izin lokasi.");break;case s.POSITION_UNAVAILABLE:m("Informasi lokasi tidak tersedia.");break;case s.TIMEOUT:m("Permintaan lokasi timeout.");break;default:m("Terjadi kesalahan saat mengambil lokasi.");break}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},z=()=>{C()};return e.jsx(G,{breadcrumbs:[{title:"Dashboard",href:"/sales"},{title:"Prospek",href:"/sales/prospects"},{title:"Tambah Prospek",href:"/sales/prospects/create"}],children:e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx("div",{className:"sticky top-0 z-10 -mx-4 -mt-4 border-b bg-background/95 backdrop-blur-sm md:relative md:mx-0 md:mt-0 md:border-0 md:bg-transparent",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 md:px-0 md:py-0",children:[e.jsx(n,{variant:"ghost",size:"sm",asChild:!0,className:"shrink-0",children:e.jsx(P,{href:"/sales/prospects",children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"truncate text-lg font-semibold md:text-2xl",children:"Tambah Prospek Baru"}),e.jsx("p",{className:"hidden text-sm text-muted-foreground md:block",children:"Inputkan data prospek customer untuk mendapat poin"})]})]})}),e.jsxs("form",{onSubmit:B,className:"space-y-4 md:space-y-6",children:[e.jsxs(h,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(j,{className:"pb-3",children:[e.jsxs(g,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(U,{className:"h-4 w-4 md:h-5 md:w-5"}),"Kategori Prospek"]}),e.jsx(N,{className:"text-sm",children:"Pilih kategori sesuai dengan jenis customer"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"prospect_category_id",className:"text-sm font-medium",children:"Kategori *"}),e.jsxs(K,{value:t.prospect_category_id,onValueChange:s=>r("prospect_category_id",s),children:[e.jsx(O,{className:"h-11 md:h-10",children:e.jsx(q,{placeholder:"Pilih kategori prospek"})}),e.jsx(V,{children:x&&x.length>0?x.map(s=>e.jsx(I,{value:s.id.toString(),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s.name}),e.jsxs(R,{variant:"secondary",className:"ml-2 text-xs",children:[s.points," poin"]})]})},s.id)):e.jsx(I,{value:"no-categories",disabled:!0,children:"Tidak ada kategori tersedia"})})]}),a.prospect_category_id&&e.jsx("p",{className:"text-xs text-destructive",children:a.prospect_category_id})]}),t.prospect_category_id&&e.jsx("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:(()=>{const s=x.find(l=>l.id.toString()===t.prospect_category_id);return s?e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),e.jsxs("p",{className:"text-xs font-medium",children:["Poin yang didapat: ",s.points]})]}):null})()})]})]}),e.jsxs(h,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(j,{className:"pb-3",children:[e.jsx(g,{className:"text-base md:text-lg",children:"Informasi Customer"}),e.jsx(N,{className:"text-sm",children:"Data kontak dan informasi customer"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"customer_name",className:"text-sm font-medium",children:"Nama Customer *"}),e.jsx(c,{id:"customer_name",type:"text",value:t.customer_name,onChange:s=>r("customer_name",s.target.value),placeholder:"Masukkan nama lengkap customer",className:"h-11 md:h-10"}),a.customer_name&&e.jsx("p",{className:"text-xs text-destructive",children:a.customer_name})]}),e.jsxs("div",{className:"space-y-4 md:grid md:grid-cols-2 md:gap-4 md:space-y-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"customer_email",className:"text-sm font-medium",children:"Email"}),e.jsx(c,{id:"customer_email",type:"email",value:t.customer_email,onChange:s=>r("customer_email",s.target.value),placeholder:"customer@email.com",className:"h-11 md:h-10"}),a.customer_email&&e.jsx("p",{className:"text-xs text-destructive",children:a.customer_email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"customer_number",className:"text-sm font-medium",children:"Nomor Telepon"}),e.jsx(c,{id:"customer_number",type:"tel",value:t.customer_number,onChange:s=>r("customer_number",s.target.value),placeholder:"08xxxxxxxxxx",className:"h-11 md:h-10"}),a.customer_number&&e.jsx("p",{className:"text-xs text-destructive",children:a.customer_number})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"address",className:"text-sm font-medium",children:"Alamat"}),e.jsx(k,{id:"address",value:t.address,onChange:s=>r("address",s.target.value),placeholder:"Alamat lengkap customer",rows:3,className:"resize-none"}),a.address&&e.jsx("p",{className:"text-xs text-destructive",children:a.address})]})]})]}),e.jsxs(h,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(j,{className:"pb-3",children:[e.jsxs(g,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(T,{className:"h-4 w-4 md:h-5 md:w-5"}),"Lokasi Sales & Koordinat"]}),e.jsx(N,{className:"text-sm",children:"Ambil lokasi sales saat ini dan koordinat untuk pemetaan"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[!o&&e.jsx("style",{children:A}),e.jsx("div",{className:"w-full sm:w-auto",children:e.jsxs(n,{type:"button",variant:"default",onClick:C,disabled:f,className:`h-11 w-full sm:w-auto md:h-10 ${o?"":"animate-soft-pulse"}`,children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),f?"Mengambil Lokasi...":"Ambil Lokasi"]})}),o&&e.jsxs(n,{type:"button",variant:"outline",onClick:z,disabled:f,className:"h-11 w-full sm:w-auto md:h-10",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Refresh Lokasi"]})]}),_&&e.jsx("div",{className:"rounded-lg border border-destructive/20 bg-destructive/10 p-3",children:e.jsx("p",{className:"text-xs text-destructive",children:_})}),D&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sales_location",className:"text-sm font-medium",children:"Lokasi Sales Saat Ini"}),e.jsx(k,{id:"sales_location",value:t.sales_location,onChange:s=>r("sales_location",s.target.value),placeholder:"Lokasi sales akan terisi otomatis...",rows:3,className:"resize-none",required:!0}),a.sales_location&&e.jsx("p",{className:"text-xs text-destructive",children:a.sales_location})]}),o&&e.jsxs("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:[e.jsx("p",{className:"text-xs font-medium text-primary",children:"Koordinat Berhasil Diambil"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Latitude: ",o.lat.toFixed(6),", Longitude: ",o.lng.toFixed(6)]})]}),e.jsxs("div",{className:"space-y-4 md:grid md:grid-cols-2 md:gap-4 md:space-y-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"latitude",className:"text-sm font-medium",children:"Latitude"}),e.jsx(c,{id:"latitude",type:"number",step:"any",value:t.latitude,onChange:s=>r("latitude",s.target.value),placeholder:"-6.200000",className:"h-11 md:h-10",required:!0}),a.latitude&&e.jsx("p",{className:"text-xs text-destructive",children:a.latitude})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"longitude",className:"text-sm font-medium",children:"Longitude"}),e.jsx(c,{id:"longitude",type:"number",step:"any",value:t.longitude,onChange:s=>r("longitude",s.target.value),placeholder:"106.816666",className:"h-11 md:h-10",required:!0}),a.longitude&&e.jsx("p",{className:"text-xs text-destructive",children:a.longitude})]})]})]})]}),e.jsxs(h,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(j,{className:"pb-3",children:[e.jsx(g,{className:"text-base md:text-lg",children:"Catatan"}),e.jsx(N,{className:"text-sm",children:"Informasi tambahan tentang prospek ini"})]}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(k,{value:t.notes,onChange:s=>r("notes",s.target.value),placeholder:"Catatan tambahan tentang prospek, kebutuhan, atau informasi penting lainnya...",rows:4,className:"resize-none"}),a.notes&&e.jsx("p",{className:"text-xs text-destructive",children:a.notes})]})})]}),e.jsx("div",{className:"sticky bottom-0 -mx-4 -mb-4 border-t bg-background/95 p-4 backdrop-blur-sm md:relative md:mx-0 md:mb-0 md:border-0 md:bg-transparent md:p-0",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs(n,{type:"submit",disabled:S,className:"h-11 flex-1 sm:flex-none md:h-10",children:[e.jsx(Q,{className:"mr-2 h-4 w-4"}),S?"Menyimpan...":"Simpan Prospek"]}),e.jsx(n,{variant:"outline",asChild:!0,className:"h-11 flex-1 sm:flex-none md:h-10",children:e.jsx(P,{href:"/sales/prospects",children:"Batal"})})]})})]})]})})}export{Se as default};
