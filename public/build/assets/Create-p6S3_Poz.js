import{r as h,x as M,j as e,t as I}from"./app-Dut1LdAE.js";import{B as $}from"./badge-DeW1Opj4.js";import{B as d}from"./createLucideIcon-C0iULVoC.js";import{C as u,a as g,b as j,d as N,c as b}from"./card-Dx9aJHDz.js";import{I as n}from"./input-D3vML1ww.js";import{L as i}from"./label-BRVQcqGu.js";import{S as R,a as K,b as O,c as V,d as P}from"./select-BkxJJpQf.js";import{T as y}from"./textarea-CJxFNjdI.js";import{S as G}from"./sales-layout-Bz_FnvHD.js";import{A as H}from"./arrow-left-TsPNlG17.js";import{T as U}from"./target-Cupp5148.js";import{M as T}from"./map-pin-Ch5_NYO2.js";import{R as q}from"./rotate-ccw-CdRC_hIX.js";import{S as J}from"./save-UYcBIVIf.js";import"./index-4ihCrLj8.js";import"./index-CRfXtssg.js";import"./index-DOUln0NY.js";import"./index-CTJ23LsC.js";import"./index-CApfq8oQ.js";import"./index-DiuZmm2K.js";import"./chevron-down-CE-Fbol3.js";import"./breadcrumbs-CcrN4L9y.js";import"./app-logo-CqiyE-ly.js";import"./index-C1Ioh-Wa.js";import"./index-BgiYP7hp.js";import"./index-hxn349B7.js";import"./chevron-right-CUpFF3n3.js";import"./chart-column-DTX-CJnC.js";import"./square-check-big-DgHCPjS0.js";function _e({categories:c}){const[x,A]=h.useState(null),[_,o]=h.useState(""),[f,v]=h.useState(!1),[E,w]=h.useState(""),{data:t,setData:r,post:D,processing:S,errors:a}=M({prospect_category_id:"",customer_name:"",customer_email:"",customer_number:"",address:"",sales_location:"",latitude:"",longitude:"",notes:""}),F=s=>{s.preventDefault(),D("/sales/prospects")},C=()=>{if(!navigator.geolocation){o("Geolocation tidak didukung oleh browser ini.");return}v(!0),o(""),navigator.geolocation.getCurrentPosition(async s=>{const{latitude:l,longitude:m}=s.coords;A({lat:l,lng:m});try{const p=(await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${l}&lon=${m}`)).json()).display_name||`${l}, ${m}`;w(p),r(z=>({...z,latitude:l.toString(),longitude:m.toString(),sales_location:p}))}catch(L){console.error("Error getting address:",L);const k=`${l}, ${m}`;w(k),r(p=>({...p,latitude:l.toString(),longitude:m.toString(),sales_location:k}))}v(!1)},s=>{switch(v(!1),s.code){case s.PERMISSION_DENIED:o("Izin lokasi ditolak. Silakan aktifkan GPS dan izin lokasi.");break;case s.POSITION_UNAVAILABLE:o("Informasi lokasi tidak tersedia.");break;case s.TIMEOUT:o("Permintaan lokasi timeout.");break;default:o("Terjadi kesalahan saat mengambil lokasi.");break}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},B=()=>{C()};return e.jsx(G,{breadcrumbs:[{title:"Dashboard",href:"/sales"},{title:"Prospek",href:"/sales/prospects"},{title:"Tambah Prospek",href:"/sales/prospects/create"}],children:e.jsxs("div",{className:"space-y-4 md:space-y-6",children:[e.jsx("div",{className:"sticky top-0 z-10 -mx-4 -mt-4 border-b bg-background/95 backdrop-blur-sm md:relative md:mx-0 md:mt-0 md:border-0 md:bg-transparent",children:e.jsxs("div",{className:"flex items-center gap-3 px-4 py-3 md:px-0 md:py-0",children:[e.jsx(d,{variant:"ghost",size:"sm",asChild:!0,className:"shrink-0",children:e.jsx(I,{href:"/sales/prospects",children:e.jsx(H,{className:"h-4 w-4"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h1",{className:"truncate text-lg font-semibold md:text-2xl",children:"Tambah Prospek Baru"}),e.jsx("p",{className:"hidden text-sm text-muted-foreground md:block",children:"Inputkan data prospek customer untuk mendapat poin"})]})]})}),e.jsxs("form",{onSubmit:F,className:"space-y-4 md:space-y-6",children:[e.jsxs(u,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(g,{className:"pb-3",children:[e.jsxs(j,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(U,{className:"h-4 w-4 md:h-5 md:w-5"}),"Kategori Prospek"]}),e.jsx(N,{className:"text-sm",children:"Pilih kategori sesuai dengan jenis customer"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"prospect_category_id",className:"text-sm font-medium",children:"Kategori *"}),e.jsxs(R,{value:t.prospect_category_id,onValueChange:s=>r("prospect_category_id",s),children:[e.jsx(K,{className:"h-11 md:h-10",children:e.jsx(O,{placeholder:"Pilih kategori prospek"})}),e.jsx(V,{children:c&&c.length>0?c.map(s=>e.jsx(P,{value:s.id.toString(),children:e.jsxs("div",{className:"flex w-full items-center justify-between",children:[e.jsx("span",{className:"text-sm",children:s.name}),e.jsxs($,{variant:"secondary",className:"ml-2 text-xs",children:[s.points," poin"]})]})},s.id)):e.jsx(P,{value:"no-categories",disabled:!0,children:"Tidak ada kategori tersedia"})})]}),a.prospect_category_id&&e.jsx("p",{className:"text-xs text-destructive",children:a.prospect_category_id})]}),t.prospect_category_id&&e.jsx("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:(()=>{const s=c.find(l=>l.id.toString()===t.prospect_category_id);return s?e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-primary",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s.description}),e.jsxs("p",{className:"text-xs font-medium",children:["Poin yang didapat: ",s.points]})]}):null})()})]})]}),e.jsxs(u,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(g,{className:"pb-3",children:[e.jsx(j,{className:"text-base md:text-lg",children:"Informasi Customer"}),e.jsx(N,{className:"text-sm",children:"Data kontak dan informasi customer"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"customer_name",className:"text-sm font-medium",children:"Nama Customer *"}),e.jsx(n,{id:"customer_name",type:"text",value:t.customer_name,onChange:s=>r("customer_name",s.target.value),placeholder:"Masukkan nama lengkap customer",className:"h-11 md:h-10"}),a.customer_name&&e.jsx("p",{className:"text-xs text-destructive",children:a.customer_name})]}),e.jsxs("div",{className:"space-y-4 md:grid md:grid-cols-2 md:gap-4 md:space-y-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"customer_email",className:"text-sm font-medium",children:"Email"}),e.jsx(n,{id:"customer_email",type:"email",value:t.customer_email,onChange:s=>r("customer_email",s.target.value),placeholder:"customer@email.com",className:"h-11 md:h-10"}),a.customer_email&&e.jsx("p",{className:"text-xs text-destructive",children:a.customer_email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"customer_number",className:"text-sm font-medium",children:"Nomor Telepon"}),e.jsx(n,{id:"customer_number",type:"tel",value:t.customer_number,onChange:s=>r("customer_number",s.target.value),placeholder:"08xxxxxxxxxx",className:"h-11 md:h-10"}),a.customer_number&&e.jsx("p",{className:"text-xs text-destructive",children:a.customer_number})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"address",className:"text-sm font-medium",children:"Alamat"}),e.jsx(y,{id:"address",value:t.address,onChange:s=>r("address",s.target.value),placeholder:"Alamat lengkap customer",rows:3,className:"resize-none"}),a.address&&e.jsx("p",{className:"text-xs text-destructive",children:a.address})]})]})]}),e.jsxs(u,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(g,{className:"pb-3",children:[e.jsxs(j,{className:"flex items-center gap-2 text-base md:text-lg",children:[e.jsx(T,{className:"h-4 w-4 md:h-5 md:w-5"}),"Lokasi Sales & Koordinat"]}),e.jsx(N,{className:"text-sm",children:"Ambil lokasi sales saat ini dan koordinat untuk pemetaan"})]}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs(d,{type:"button",variant:"outline",onClick:C,disabled:f,className:"h-11 w-full sm:w-auto md:h-10",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),f?"Mengambil Lokasi...":"Ambil Lokasi"]}),x&&e.jsxs(d,{type:"button",variant:"outline",onClick:B,disabled:f,className:"h-11 w-full sm:w-auto md:h-10",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Refresh Lokasi"]})]}),_&&e.jsx("div",{className:"rounded-lg border border-destructive/20 bg-destructive/10 p-3",children:e.jsx("p",{className:"text-xs text-destructive",children:_})}),E&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"sales_location",className:"text-sm font-medium",children:"Lokasi Sales Saat Ini"}),e.jsx(y,{id:"sales_location",value:t.sales_location,onChange:s=>r("sales_location",s.target.value),placeholder:"Lokasi sales akan terisi otomatis...",rows:3,className:"resize-none"}),a.sales_location&&e.jsx("p",{className:"text-xs text-destructive",children:a.sales_location})]}),x&&e.jsxs("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-3",children:[e.jsx("p",{className:"text-xs font-medium text-primary",children:"Koordinat Berhasil Diambil"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Latitude: ",x.lat.toFixed(6),", Longitude: ",x.lng.toFixed(6)]})]}),e.jsxs("div",{className:"space-y-4 md:grid md:grid-cols-2 md:gap-4 md:space-y-0",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"latitude",className:"text-sm font-medium",children:"Latitude"}),e.jsx(n,{id:"latitude",type:"number",step:"any",value:t.latitude,onChange:s=>r("latitude",s.target.value),placeholder:"-6.200000",className:"h-11 md:h-10"}),a.latitude&&e.jsx("p",{className:"text-xs text-destructive",children:a.latitude})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"longitude",className:"text-sm font-medium",children:"Longitude"}),e.jsx(n,{id:"longitude",type:"number",step:"any",value:t.longitude,onChange:s=>r("longitude",s.target.value),placeholder:"106.816666",className:"h-11 md:h-10"}),a.longitude&&e.jsx("p",{className:"text-xs text-destructive",children:a.longitude})]})]})]})]}),e.jsxs(u,{className:"border-0 shadow-sm md:border md:shadow-none",children:[e.jsxs(g,{className:"pb-3",children:[e.jsx(j,{className:"text-base md:text-lg",children:"Catatan"}),e.jsx(N,{className:"text-sm",children:"Informasi tambahan tentang prospek ini"})]}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{value:t.notes,onChange:s=>r("notes",s.target.value),placeholder:"Catatan tambahan tentang prospek, kebutuhan, atau informasi penting lainnya...",rows:4,className:"resize-none"}),a.notes&&e.jsx("p",{className:"text-xs text-destructive",children:a.notes})]})})]}),e.jsx("div",{className:"sticky bottom-0 -mx-4 -mb-4 border-t bg-background/95 p-4 backdrop-blur-sm md:relative md:mx-0 md:mb-0 md:border-0 md:bg-transparent md:p-0",children:e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row",children:[e.jsxs(d,{type:"submit",disabled:S,className:"h-11 flex-1 sm:flex-none md:h-10",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),S?"Menyimpan...":"Simpan Prospek"]}),e.jsx(d,{variant:"outline",asChild:!0,className:"h-11 flex-1 sm:flex-none md:h-10",children:e.jsx(I,{href:"/sales/prospects",children:"Batal"})})]})})]})]})})}export{_e as default};
