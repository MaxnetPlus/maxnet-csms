import{J as B,r as m,j as e,Q as L,t,S as c}from"./app-_Law41MO.js";import{B as w}from"./badge-DCl5Qm1j.js";import{c as y,B as a}from"./createLucideIcon-DZsZKup7.js";import{C as u,a as p,b as v,d as f,c as g}from"./card-HfH5FNfs.js";import{D as F}from"./data-table-BYvxkVsq.js";import{D as S,b as k,c as U,d as I,e as M,f as R}from"./dialog-xuoL27Lf.js";import{I as O}from"./input-CiUjjTQa.js";import{A as Q,X as V}from"./app-layout-BJCYEiDk.js";import{H as q,R as J}from"./refresh-ccw-DQD2go41.js";import{M as X}from"./mail-uwbxcLas.js";import{S as G}from"./search-GHqcTXhE.js";import{P as W}from"./pencil-D3ii6pzi.js";import{T as Y}from"./trash-2-DYZGeTGG.js";import"./chevron-left-BoaflWkZ.js";import"./chevron-right-DXHZ-DBl.js";import"./index-9bZlOoc5.js";import"./index-BXfcxltX.js";import"./app-logo-CwI_ENBz.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ee=y("Eye",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ae=y("Plus",se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],re=y("UserPlus",ne),ie=[{title:"Dashboard",href:"/dashboard"},{title:"User Management",href:"/admin/users"}];function De({users:r,invitations:o,roles:z,filters:N}){var D;const{auth:j}=B().props,n=((D=j==null?void 0:j.user)==null?void 0:D.permissions)||[];console.log("User Permissions:",n);const[C,A]=m.useState(N.search||""),[b,T]=m.useState(N.role||""),[i,h]=m.useState(null),[l,x]=m.useState(null),$=s=>{s.preventDefault(),c.get("/admin/users",{search:C,role:b},{preserveState:!0,replace:!0})},E=s=>{c.delete(`/admin/users/${s.id}`,{onSuccess:()=>h(null)})},H=s=>{c.delete(`/admin/users/invitations/${s.id}`,{onSuccess:()=>x(null)})},K=s=>{c.post(`/admin/users/invitations/${s.id}/resend`)},P=[{header:"Name",accessorKey:"name",cell:s=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.email})]})},{header:"Roles",accessorKey:"roles",cell:s=>{var d;return e.jsx("div",{className:"flex flex-wrap gap-1",children:((d=s.roles)==null?void 0:d.map(_=>e.jsx(w,{variant:"secondary",children:_.name},_.id)))||e.jsx("span",{className:"text-muted-foreground",children:"No roles"})})}},{header:"Email Verified",accessorKey:"email_verified_at",cell:s=>e.jsx(w,{variant:s.email_verified_at?"default":"destructive",children:s.email_verified_at?"Verified":"Unverified"})},{header:"Created",accessorKey:"created_at",cell:s=>new Date(s.created_at).toLocaleDateString()},{header:"Actions",accessorKey:"id",cell:s=>n!=null&&n.includes("manage-users")?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(t,{href:`/admin/users/${s.id}`,children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(t,{href:`/admin/users/${s.id}/edit`,children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>h(s),className:"text-destructive hover:text-destructive",children:e.jsx(Y,{className:"h-4 w-4"})})]}):null}];return e.jsxs(Q,{breadcrumbs:ie,children:[e.jsx(L,{title:"User Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users and their permissions"})]}),(n==null?void 0:n.includes("manage-users"))&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(t,{href:"/admin/users/invitation-history",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Invitation History"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(t,{href:"/admin/users/invite",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Invite User"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(t,{href:"/admin/users/sso-pending",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Pending SSO Users"]})}),e.jsx(a,{asChild:!0,children:e.jsxs(t,{href:"/admin/users/create",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Add User"]})})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(v,{children:"Filters"}),e.jsx(f,{children:"Filter users by search term and role"})]}),e.jsx(g,{children:e.jsxs("form",{onSubmit:$,className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(O,{placeholder:"Search by name or email...",value:C,onChange:s=>A(s.target.value)})}),e.jsx("div",{className:"w-48",children:e.jsxs("select",{value:b,onChange:s=>T(s.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"",children:"All Roles"}),z.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})}),e.jsxs(a,{type:"submit",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Search"]})]})})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Users (",r.total,")"]}),e.jsx(f,{children:"All users in the system"})]}),e.jsxs(g,{children:[e.jsx(F,{columns:P,data:r.data,searchKey:"name",searchPlaceholder:"Search users..."}),e.jsx("div",{className:"flex items-center justify-between space-x-2 py-4",children:e.jsxs("div",{className:"space-x-2",children:[r.prev_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>c.visit(r.prev_page_url),children:"Previous"}),r.next_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>c.visit(r.next_page_url),children:"Next"})]})})]})]}),o&&o.length>0&&(n==null?void 0:n.includes("manage-users"))&&e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Pending Invitations (",o.length,")"]}),e.jsx(f,{children:"Users who have been invited but haven't accepted yet"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-4",children:o.map(s=>{var d;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Role: ",s.role]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Invited by: ",(d=s.inviter)==null?void 0:d.name]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>K(s),title:"Resend invitation",children:e.jsx(J,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>x(s),className:"text-destructive hover:text-destructive",title:"Cancel invitation",children:e.jsx(V,{className:"h-4 w-4"})})]})]},s.id)})})})]})]}),e.jsx(S,{open:!!i,onOpenChange:()=>h(null),children:e.jsxs(k,{children:[e.jsxs(U,{children:[e.jsx(I,{children:"Delete User"}),e.jsxs(M,{children:["Are you sure you want to delete ",i==null?void 0:i.name,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>i&&E(i),children:"Delete"})]})]})}),e.jsx(S,{open:!!l,onOpenChange:()=>x(null),children:e.jsxs(k,{children:[e.jsxs(U,{children:[e.jsx(I,{children:"Cancel Invitation"}),e.jsxs(M,{children:["Are you sure you want to cancel the invitation for ",l==null?void 0:l.email,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>x(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>l&&H(l),children:"Cancel Invitation"})]})]})})]})}export{De as default};
