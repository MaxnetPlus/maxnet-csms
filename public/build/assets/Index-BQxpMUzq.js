import{r as m,S as f,j as e,t as S}from"./app-Aw6YSH6g.js";import{B}from"./badge-CIMVAU4m.js";import{B as d}from"./createLucideIcon-D6F2HjNJ.js";import{C as h,a as z,b as L,c as j}from"./card-Bb0v4BpC.js";import{I as N}from"./input-DDWDjiWn.js";import{S as _,a as w,b as D,c as k,d as c}from"./select-Btd99lWl.js";import{S as O}from"./sales-layout-Ua4EjijN.js";import{P as y}from"./plus-CABKRbQ-.js";import{F}from"./filter-DKROJXAI.js";import{S as H}from"./search-BejOA3Ep.js";import{M as $}from"./map-pin-NmMPXV0O.js";import{U as K}from"./breadcrumbs-qVQ5pWbj.js";import"./index-CS0-MCoE.js";import"./index-hDe8CdPJ.js";import"./index-COA2UNkf.js";import"./index-BMgGVTnd.js";import"./index-BfqNDOgH.js";import"./index-4OnYSvy0.js";import"./chevron-down-XTd1Aqfr.js";import"./app-logo-Crmkh7xx.js";import"./chart-column-D3ayj0F1.js";import"./square-check-big-oINFdxmX.js";import"./index-CBCVPOvL.js";import"./index-BaexZHHE.js";import"./index-C1N_NOKC.js";import"./chevron-right-DlF4IjTy.js";function xe({prospects:l,categories:T,filters:n}){const[o,g]=m.useState(n.search||""),[i,v]=m.useState(n.status||"all"),[r,p]=m.useState(n.category_id||"all"),b=new Date().toISOString().split("T")[0],[s,x]=m.useState(n.date_from||(!n.date_from&&!n.date_to?b:"")),[t,u]=m.useState(n.date_to||(!n.date_from&&!n.date_to?b:""));m.useEffect(()=>{const a=setTimeout(()=>{f.get("/sales/prospects",{search:o||void 0,status:i!=="all"?i:void 0,category_id:r!=="all"?r:void 0,date_from:s||void 0,date_to:t||void 0},{preserveState:!0,replace:!0})},300);return()=>clearTimeout(a)},[o,i,r,s,t]);const C=a=>({new:"default",contacted:"secondary",qualified:"outline",converted:"success",rejected:"destructive"})[a]||"default",I=a=>({new:"Baru",contacted:"Dihubungi",qualified:"Terkualifikasi",converted:"Terkonversi",rejected:"Ditolak"})[a]||a;return e.jsx(O,{breadcrumbs:[{title:"Dashboard",href:"/sales"},{title:"Prospek",href:"/sales/prospects"}],children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Kelola Prospek"}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsxs("p",{children:["Total ",l.total," prospek"]}),s&&t&&s===t&&s===new Date().toISOString().split("T")[0]&&e.jsx("span",{className:"rounded bg-blue-50 px-2 py-1 text-sm text-blue-600",children:"• Hari ini"}),s&&t&&(s!==t||s!==new Date().toISOString().split("T")[0])&&e.jsxs("span",{className:"rounded bg-orange-50 px-2 py-1 text-sm text-orange-600",children:["•"," ",s===t?`Tanggal ${new Date(s).toLocaleDateString("id-ID")}`:`${new Date(s).toLocaleDateString("id-ID")} - ${new Date(t).toLocaleDateString("id-ID")}`]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[!(s&&t&&s===t&&s===new Date().toISOString().split("T")[0])&&e.jsx(d,{variant:"outline",size:"sm",onClick:()=>{const a=new Date().toISOString().split("T")[0];x(a),u(a)},className:"w-full sm:w-auto",children:"Tampilkan Hari Ini"}),e.jsx(d,{asChild:!0,className:"w-full sm:w-auto",children:e.jsxs(S,{href:"/sales/prospects/create",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Tambah Prospek"]})})]})]}),e.jsxs(h,{children:[e.jsx(z,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-5 w-5"}),"Filter & Pencarian"]})}),e.jsx(j,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{children:e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute top-1/2 left-3 h-4 w-4 -translate-y-1/2 transform text-muted-foreground"}),e.jsx(N,{placeholder:"Cari nama, email, nomor, atau alamat...",value:o,onChange:a=>g(a.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Status"}),e.jsxs(_,{value:i,onValueChange:v,children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Semua Status"})}),e.jsxs(k,{children:[e.jsx(c,{value:"all",children:"Semua Status"}),e.jsx(c,{value:"new",children:"Baru"}),e.jsx(c,{value:"contacted",children:"Dihubungi"}),e.jsx(c,{value:"qualified",children:"Terkualifikasi"}),e.jsx(c,{value:"converted",children:"Terkonversi"}),e.jsx(c,{value:"rejected",children:"Ditolak"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Kategori"}),e.jsxs(_,{value:r,onValueChange:p,children:[e.jsx(w,{children:e.jsx(D,{placeholder:"Semua Kategori"})}),e.jsxs(k,{children:[e.jsx(c,{value:"all",children:"Semua Kategori"}),T.map(a=>e.jsxs(c,{value:a.id.toString(),children:[a.name," (",a.points," poin)"]},a.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Tanggal Dari"}),e.jsx(N,{type:"date",value:s,onChange:a=>x(a.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"mb-2 block text-sm font-medium",children:"Tanggal Sampai"}),e.jsx(N,{type:"date",value:t,onChange:a=>u(a.target.value)})]})]}),(o||i!=="all"||r!=="all"||s&&t&&!(s===t&&s===new Date().toISOString().split("T")[0]))&&e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",onClick:()=>{const a=new Date().toISOString().split("T")[0];g(""),v("all"),p("all"),x(a),u(a)},children:"Reset ke Hari Ini"}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>{g(""),v("all"),p("all"),x(""),u("")},children:"Hapus Semua Filter"})]})]})})]}),e.jsx("div",{className:"space-y-4",children:l.data.length>0?l.data.map(a=>e.jsx(h,{className:"transition-shadow hover:shadow-md",children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsxs("div",{className:"mb-2 flex flex-col gap-2 sm:flex-row sm:items-center",children:[e.jsx("h3",{className:"truncate text-lg font-semibold",children:a.customer_name}),e.jsx(B,{variant:C(a.status),children:I(a.status)})]}),e.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[a.customer_email&&e.jsxs("p",{children:["📧 ",a.customer_email]}),a.customer_number&&e.jsxs("p",{children:["📱 ",a.customer_number]}),a.category&&e.jsxs("p",{children:["🏷️ ",a.category.name," (",a.category.points," poin)"]}),a.address&&e.jsxs("p",{className:"truncate",children:["📍 Customer: ",a.address]}),a.sales_location&&e.jsxs("p",{className:"truncate",children:["📍 Sales: ",a.sales_location]})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-xs text-muted-foreground",children:[e.jsxs("span",{children:["Dibuat: ",new Date(a.created_at).toLocaleDateString("id-ID")]}),a.converted_at&&e.jsxs("span",{children:["Konversi: ",new Date(a.converted_at).toLocaleDateString("id-ID")]})]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(d,{variant:"outline",size:"sm",asChild:!0,children:e.jsx(S,{href:`/sales/prospects/${a.id}`,children:"Detail"})}),a.latitude&&a.longitude&&e.jsx(d,{variant:"ghost",size:"sm",className:"text-primary",children:e.jsx($,{className:"h-4 w-4"})})]})]})})},a.id)):e.jsx(h,{children:e.jsxs(j,{className:"p-8 text-center",children:[e.jsx(K,{className:"mx-auto mb-4 h-12 w-12 text-muted-foreground"}),e.jsx("h3",{className:"mb-2 text-lg font-semibold",children:"Belum Ada Prospek"}),e.jsx("p",{className:"mb-4 text-muted-foreground",children:o||i!=="all"||r!=="all"||s||t?"Tidak ada prospek yang sesuai dengan filter.":"Mulai tambahkan prospek pertama Anda."}),!o&&i==="all"&&r==="all"&&!s&&!t&&e.jsx(d,{asChild:!0,children:e.jsxs(S,{href:"/sales/prospects/create",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Tambah Prospek"]})})]})})}),l.last_page>1&&e.jsx(h,{children:e.jsx(j,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Halaman ",l.current_page," dari ",l.last_page]}),e.jsxs("div",{className:"flex gap-2",children:[l.current_page>1&&e.jsx(d,{variant:"outline",size:"sm",onClick:()=>f.get(`/sales/prospects?page=${l.current_page-1}`,{search:o||void 0,status:i!=="all"?i:void 0,category_id:r!=="all"?r:void 0,date_from:s||void 0,date_to:t||void 0}),children:"Sebelumnya"}),l.current_page<l.last_page&&e.jsx(d,{variant:"outline",size:"sm",onClick:()=>f.get(`/sales/prospects?page=${l.current_page+1}`,{search:o||void 0,status:i!=="all"?i:void 0,category_id:r!=="all"?r:void 0,date_from:s||void 0,date_to:t||void 0}),children:"Selanjutnya"})]})]})})})]})})}export{xe as default};
