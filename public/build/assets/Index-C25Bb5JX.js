import{r as h,x as S,j as e,Q as re,S as A}from"./app-B2hYMNI5.js";import{B as le}from"./badge-8wrSQBmR.js";import{B as n}from"./createLucideIcon-DV_iH8MW.js";import{C as q,a as z,b as B,d as L,c as I}from"./card-Cm0bTvNT.js";import{C as H}from"./checkbox-BQupjr-k.js";import{D as o,f as K,a as x,b as p,c as j,d as u,e as g}from"./dialog-Du_bGPTE.js";import{F as k,a as f,b as C,c as v}from"./form-BNVIrPVD.js";import{I as F}from"./input-BRbBuD6E.js";import{L as Q}from"./label-Cz4ISq_6.js";import{A as te,S as G}from"./app-layout-dhacHFzS.js";import{K as J}from"./key-CuXl4rlb.js";import{P as V}from"./pencil-CQ8kkuJz.js";import{T as W}from"./trash-2-JDwduq2I.js";import"./index-CM3CHnuf.js";import"./index-Bkr1NFrf.js";import"./index-MU9arsYp.js";import"./index-C74G8zdK.js";import"./index-Dkk_Qt6x.js";import"./index-D90rp3hY.js";import"./index-liacH3qE.js";import"./breadcrumbs-kb4jvroI.js";import"./app-logo-DAmxlVvw.js";import"./index-uqU1JcBO.js";import"./index-B49Zg7V3.js";import"./chevron-right-Dd4b5nL4.js";import"./chevron-down-CwpXDSUf.js";import"./file-text-D6HImMR6.js";import"./trending-up-BJVc80kP.js";import"./target-BiGQP1qa.js";const oe=[{title:"Dashboard",href:"/dashboard"},{title:"Role & Permission Management",href:"/admin/roles-permissions"}];function qe({roles:E,permissions:N}){const[$,b]=h.useState(!1),[M,w]=h.useState(!1),[O,D]=h.useState(null),[U,y]=h.useState(null),[c,P]=h.useState(null),[m,R]=h.useState(null),r=S({name:"",permissions:[]}),d=S({name:""}),i=S({name:"",permissions:[]}),t=S({name:""}),X=s=>{s.preventDefault(),r.post("/admin/roles",{onSuccess:()=>{r.reset(),b(!1)}})},Y=s=>{s.preventDefault(),d.post("/admin/permissions",{onSuccess:()=>{d.reset(),w(!1)}})},Z=s=>{var a;D(s),i.setData({name:s.name,permissions:((a=s.permissions)==null?void 0:a.map(l=>l.name))||[]})},_=s=>{s.preventDefault(),O&&i.put(`/admin/roles/${O.id}`,{onSuccess:()=>{i.reset(),D(null)}})},ee=s=>{y(s),t.setData({name:s.name})},se=s=>{s.preventDefault(),U&&t.put(`/admin/permissions/${U.id}`,{onSuccess:()=>{t.reset(),y(null)}})},ne=s=>{A.delete(`/admin/roles/${s.id}`,{onSuccess:()=>P(null)})},ie=s=>{A.delete(`/admin/permissions/${s.id}`,{onSuccess:()=>R(null)})},T=(s,a,l)=>{a?l.setData("permissions",[...l.data.permissions,s]):l.setData("permissions",l.data.permissions.filter(ae=>ae!==s))};return e.jsxs(te,{breadcrumbs:oe,children:[e.jsx(re,{title:"Role & Permission Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Role & Permission Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system roles and permissions"})]}),e.jsxs("div",{className:"mt-4 flex flex-col gap-2 md:mt-0 md:flex-row",children:[e.jsx(o,{open:M,onOpenChange:w,children:e.jsx(K,{asChild:!0,children:e.jsxs(n,{variant:"outline",className:"w-full md:w-auto",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Add Permission"]})})}),e.jsx(o,{open:$,onOpenChange:b,children:e.jsx(K,{asChild:!0,children:e.jsxs(n,{className:"w-full md:w-auto",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Add Role"]})})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(q,{children:[e.jsxs(z,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Roles (",E.length,")"]}),e.jsx(L,{children:"Manage user roles and their permissions"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[E.map(s=>{var a;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:((a=s.permissions)==null?void 0:a.map(l=>e.jsx(le,{variant:"secondary",className:"text-xs",children:l.name},l.id)))||e.jsx("span",{className:"text-sm text-muted-foreground",children:"No permissions"})})]}),e.jsxs("div",{className:"ml-4 flex gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>Z(s),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>P(s),className:"text-destructive hover:text-destructive",children:e.jsx(W,{className:"h-4 w-4"})})]})]},s.id)}),E.length===0&&e.jsx("p",{className:"py-8 text-center text-muted-foreground",children:"No roles found"})]})})]}),e.jsxs(q,{children:[e.jsxs(z,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Permissions (",N.length,")"]}),e.jsx(L,{children:"Manage system permissions"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[N.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>ee(s),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>R(s),className:"text-destructive hover:text-destructive",children:e.jsx(W,{className:"h-4 w-4"})})]})]},s.id)),N.length===0&&e.jsx("p",{className:"py-8 text-center text-muted-foreground",children:"No permissions found"})]})})]})]})]}),e.jsx(o,{open:$,onOpenChange:b,children:e.jsxs(x,{className:"max-w-2xl",children:[e.jsxs(p,{children:[e.jsx(j,{children:"Create New Role"}),e.jsx(u,{children:"Create a new role and assign permissions to it."})]}),e.jsxs(k,{onSubmit:X,children:[e.jsxs(f,{children:[e.jsx(C,{htmlFor:"role-name",required:!0,children:"Role Name"}),e.jsx(F,{id:"role-name",value:r.data.name,onChange:s=>r.setData("name",s.target.value),placeholder:"Enter role name"}),e.jsx(v,{children:r.errors.name})]}),e.jsxs(f,{children:[e.jsx(C,{children:"Permissions"}),e.jsx("div",{className:"grid max-h-64 grid-cols-2 gap-3 overflow-y-auto rounded-lg border p-4",children:N.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:`create-permission-${s.id}`,checked:r.data.permissions.includes(s.name),onCheckedChange:a=>T(s.name,a,r)}),e.jsx(Q,{htmlFor:`create-permission-${s.id}`,className:"text-sm",children:s.name})]},s.id))}),e.jsx(v,{children:r.errors.permissions})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:r.processing,children:r.processing?"Creating...":"Create Role"})]})]})]})}),e.jsx(o,{open:!!O,onOpenChange:()=>D(null),children:e.jsxs(x,{className:"max-w-2xl",children:[e.jsxs(p,{children:[e.jsx(j,{children:"Edit Role"}),e.jsx(u,{children:"Update role information and permissions."})]}),e.jsxs(k,{onSubmit:_,children:[e.jsxs(f,{children:[e.jsx(C,{htmlFor:"edit-role-name",required:!0,children:"Role Name"}),e.jsx(F,{id:"edit-role-name",value:i.data.name,onChange:s=>i.setData("name",s.target.value),placeholder:"Enter role name"}),e.jsx(v,{children:i.errors.name})]}),e.jsxs(f,{children:[e.jsx(C,{children:"Permissions"}),e.jsx("div",{className:"grid max-h-64 grid-cols-2 gap-3 overflow-y-auto rounded-lg border p-4",children:N.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:`edit-permission-${s.id}`,checked:i.data.permissions.includes(s.name),onCheckedChange:a=>T(s.name,a,i)}),e.jsx(Q,{htmlFor:`edit-permission-${s.id}`,className:"text-sm",children:s.name})]},s.id))}),e.jsx(v,{children:i.errors.permissions})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>D(null),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:i.processing,children:i.processing?"Updating...":"Update Role"})]})]})]})}),e.jsx(o,{open:M,onOpenChange:w,children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Create New Permission"}),e.jsx(u,{children:"Create a new permission that can be assigned to roles."})]}),e.jsxs(k,{onSubmit:Y,children:[e.jsxs(f,{children:[e.jsx(C,{htmlFor:"permission-name",required:!0,children:"Permission Name"}),e.jsx(F,{id:"permission-name",value:d.data.name,onChange:s=>d.setData("name",s.target.value),placeholder:"Enter permission name (e.g., manage-reports)"}),e.jsx(v,{children:d.errors.name})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>w(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:d.processing,children:d.processing?"Creating...":"Create Permission"})]})]})]})}),e.jsx(o,{open:!!U,onOpenChange:()=>y(null),children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Edit Permission"}),e.jsx(u,{children:"Update permission information."})]}),e.jsxs(k,{onSubmit:se,children:[e.jsxs(f,{children:[e.jsx(C,{htmlFor:"edit-permission-name",required:!0,children:"Permission Name"}),e.jsx(F,{id:"edit-permission-name",value:t.data.name,onChange:s=>t.setData("name",s.target.value),placeholder:"Enter permission name"}),e.jsx(v,{children:t.errors.name})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>y(null),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:t.processing,children:t.processing?"Updating...":"Update Permission"})]})]})]})}),e.jsx(o,{open:!!c,onOpenChange:()=>P(null),children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Delete Role"}),e.jsxs(u,{children:['Are you sure you want to delete the role "',c==null?void 0:c.name,'"? This action cannot be undone.']})]}),e.jsxs(g,{children:[e.jsx(n,{variant:"outline",onClick:()=>P(null),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:()=>c&&ne(c),children:"Delete"})]})]})}),e.jsx(o,{open:!!m,onOpenChange:()=>R(null),children:e.jsxs(x,{children:[e.jsxs(p,{children:[e.jsx(j,{children:"Delete Permission"}),e.jsxs(u,{children:['Are you sure you want to delete the permission "',m==null?void 0:m.name,'"? This action cannot be undone.']})]}),e.jsxs(g,{children:[e.jsx(n,{variant:"outline",onClick:()=>R(null),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:()=>m&&ie(m),children:"Delete"})]})]})})]})}export{qe as default};
