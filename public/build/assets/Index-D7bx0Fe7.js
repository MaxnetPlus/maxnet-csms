import{r as h,x as S,j as e,Q as re,S as A}from"./app-D9LJmzs7.js";import{B as le}from"./badge-BB5FTKHD.js";import{B as n}from"./createLucideIcon-qSFQSRCF.js";import{C as q,a as z,b as B,d as L,c as I}from"./card-CCPFm4Y_.js";import{C as H}from"./checkbox-Bapr0xCw.js";import{D as o,a as K,b as x,c as j,d as p,e as u,f as g}from"./dialog-aVkxJ2fV.js";import{F as k,a as C,b as f,c as v}from"./form-B_OAJ7Wd.js";import{I as F}from"./input-BJuj_qIJ.js";import{L as Q}from"./label-D-_MIWMv.js";import{A as te,S as G}from"./app-layout-CEczqHvJ.js";import{K as J}from"./key-CWOrtxje.js";import{P as V}from"./pencil-BZzNxz98.js";import{T as W}from"./trash-2-EFtXXdHr.js";import"./index-D_1gtd8-.js";import"./index-BkaWxuL0.js";import"./index-CCLeDixH.js";import"./app-logo-xriozCOx.js";import"./chevron-right-5NsYTwQk.js";const oe=[{title:"Dashboard",href:"/dashboard"},{title:"Role & Permission Management",href:"/admin/roles-permissions"}];function Re({roles:E,permissions:N}){const[$,b]=h.useState(!1),[M,D]=h.useState(!1),[O,y]=h.useState(null),[U,P]=h.useState(null),[c,w]=h.useState(null),[m,R]=h.useState(null),r=S({name:"",permissions:[]}),d=S({name:""}),i=S({name:"",permissions:[]}),t=S({name:""}),X=s=>{s.preventDefault(),r.post("/admin/roles",{onSuccess:()=>{r.reset(),b(!1)}})},Y=s=>{s.preventDefault(),d.post("/admin/permissions",{onSuccess:()=>{d.reset(),D(!1)}})},Z=s=>{var a;y(s),i.setData({name:s.name,permissions:((a=s.permissions)==null?void 0:a.map(l=>l.name))||[]})},_=s=>{s.preventDefault(),O&&i.put(`/admin/roles/${O.id}`,{onSuccess:()=>{i.reset(),y(null)}})},ee=s=>{P(s),t.setData({name:s.name})},se=s=>{s.preventDefault(),U&&t.put(`/admin/permissions/${U.id}`,{onSuccess:()=>{t.reset(),P(null)}})},ne=s=>{A.delete(`/admin/roles/${s.id}`,{onSuccess:()=>w(null)})},ie=s=>{A.delete(`/admin/permissions/${s.id}`,{onSuccess:()=>R(null)})},T=(s,a,l)=>{a?l.setData("permissions",[...l.data.permissions,s]):l.setData("permissions",l.data.permissions.filter(ae=>ae!==s))};return e.jsxs(te,{breadcrumbs:oe,children:[e.jsx(re,{title:"Role & Permission Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Role & Permission Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage system roles and permissions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{open:M,onOpenChange:D,children:e.jsx(K,{asChild:!0,children:e.jsxs(n,{variant:"outline",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Add Permission"]})})}),e.jsx(o,{open:$,onOpenChange:b,children:e.jsx(K,{asChild:!0,children:e.jsxs(n,{children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Add Role"]})})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(q,{children:[e.jsxs(z,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5"}),"Roles (",E.length,")"]}),e.jsx(L,{children:"Manage user roles and their permissions"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-4",children:[E.map(s=>{var a;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium",children:s.name}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:((a=s.permissions)==null?void 0:a.map(l=>e.jsx(le,{variant:"secondary",className:"text-xs",children:l.name},l.id)))||e.jsx("span",{className:"text-sm text-muted-foreground",children:"No permissions"})})]}),e.jsxs("div",{className:"ml-4 flex gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>Z(s),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>w(s),className:"text-destructive hover:text-destructive",children:e.jsx(W,{className:"h-4 w-4"})})]})]},s.id)}),E.length===0&&e.jsx("p",{className:"py-8 text-center text-muted-foreground",children:"No roles found"})]})})]}),e.jsxs(q,{children:[e.jsxs(z,{children:[e.jsxs(B,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5"}),"Permissions (",N.length,")"]}),e.jsx(L,{children:"Manage system permissions"})]}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-2",children:[N.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>ee(s),children:e.jsx(V,{className:"h-4 w-4"})}),e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>R(s),className:"text-destructive hover:text-destructive",children:e.jsx(W,{className:"h-4 w-4"})})]})]},s.id)),N.length===0&&e.jsx("p",{className:"py-8 text-center text-muted-foreground",children:"No permissions found"})]})})]})]})]}),e.jsx(o,{open:$,onOpenChange:b,children:e.jsxs(x,{className:"max-w-2xl",children:[e.jsxs(j,{children:[e.jsx(p,{children:"Create New Role"}),e.jsx(u,{children:"Create a new role and assign permissions to it."})]}),e.jsxs(k,{onSubmit:X,children:[e.jsxs(C,{children:[e.jsx(f,{htmlFor:"role-name",required:!0,children:"Role Name"}),e.jsx(F,{id:"role-name",value:r.data.name,onChange:s=>r.setData("name",s.target.value),placeholder:"Enter role name"}),e.jsx(v,{children:r.errors.name})]}),e.jsxs(C,{children:[e.jsx(f,{children:"Permissions"}),e.jsx("div",{className:"grid max-h-64 grid-cols-2 gap-3 overflow-y-auto rounded-lg border p-4",children:N.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:`create-permission-${s.id}`,checked:r.data.permissions.includes(s.name),onCheckedChange:a=>T(s.name,a,r)}),e.jsx(Q,{htmlFor:`create-permission-${s.id}`,className:"text-sm",children:s.name})]},s.id))}),e.jsx(v,{children:r.errors.permissions})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>b(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:r.processing,children:r.processing?"Creating...":"Create Role"})]})]})]})}),e.jsx(o,{open:!!O,onOpenChange:()=>y(null),children:e.jsxs(x,{className:"max-w-2xl",children:[e.jsxs(j,{children:[e.jsx(p,{children:"Edit Role"}),e.jsx(u,{children:"Update role information and permissions."})]}),e.jsxs(k,{onSubmit:_,children:[e.jsxs(C,{children:[e.jsx(f,{htmlFor:"edit-role-name",required:!0,children:"Role Name"}),e.jsx(F,{id:"edit-role-name",value:i.data.name,onChange:s=>i.setData("name",s.target.value),placeholder:"Enter role name"}),e.jsx(v,{children:i.errors.name})]}),e.jsxs(C,{children:[e.jsx(f,{children:"Permissions"}),e.jsx("div",{className:"grid max-h-64 grid-cols-2 gap-3 overflow-y-auto rounded-lg border p-4",children:N.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(H,{id:`edit-permission-${s.id}`,checked:i.data.permissions.includes(s.name),onCheckedChange:a=>T(s.name,a,i)}),e.jsx(Q,{htmlFor:`edit-permission-${s.id}`,className:"text-sm",children:s.name})]},s.id))}),e.jsx(v,{children:i.errors.permissions})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>y(null),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:i.processing,children:i.processing?"Updating...":"Update Role"})]})]})]})}),e.jsx(o,{open:M,onOpenChange:D,children:e.jsxs(x,{children:[e.jsxs(j,{children:[e.jsx(p,{children:"Create New Permission"}),e.jsx(u,{children:"Create a new permission that can be assigned to roles."})]}),e.jsxs(k,{onSubmit:Y,children:[e.jsxs(C,{children:[e.jsx(f,{htmlFor:"permission-name",required:!0,children:"Permission Name"}),e.jsx(F,{id:"permission-name",value:d.data.name,onChange:s=>d.setData("name",s.target.value),placeholder:"Enter permission name (e.g., manage-reports)"}),e.jsx(v,{children:d.errors.name})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>D(!1),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:d.processing,children:d.processing?"Creating...":"Create Permission"})]})]})]})}),e.jsx(o,{open:!!U,onOpenChange:()=>P(null),children:e.jsxs(x,{children:[e.jsxs(j,{children:[e.jsx(p,{children:"Edit Permission"}),e.jsx(u,{children:"Update permission information."})]}),e.jsxs(k,{onSubmit:se,children:[e.jsxs(C,{children:[e.jsx(f,{htmlFor:"edit-permission-name",required:!0,children:"Permission Name"}),e.jsx(F,{id:"edit-permission-name",value:t.data.name,onChange:s=>t.setData("name",s.target.value),placeholder:"Enter permission name"}),e.jsx(v,{children:t.errors.name})]}),e.jsxs(g,{children:[e.jsx(n,{type:"button",variant:"outline",onClick:()=>P(null),children:"Cancel"}),e.jsx(n,{type:"submit",disabled:t.processing,children:t.processing?"Updating...":"Update Permission"})]})]})]})}),e.jsx(o,{open:!!c,onOpenChange:()=>w(null),children:e.jsxs(x,{children:[e.jsxs(j,{children:[e.jsx(p,{children:"Delete Role"}),e.jsxs(u,{children:['Are you sure you want to delete the role "',c==null?void 0:c.name,'"? This action cannot be undone.']})]}),e.jsxs(g,{children:[e.jsx(n,{variant:"outline",onClick:()=>w(null),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:()=>c&&ne(c),children:"Delete"})]})]})}),e.jsx(o,{open:!!m,onOpenChange:()=>R(null),children:e.jsxs(x,{children:[e.jsxs(j,{children:[e.jsx(p,{children:"Delete Permission"}),e.jsxs(u,{children:['Are you sure you want to delete the permission "',m==null?void 0:m.name,'"? This action cannot be undone.']})]}),e.jsxs(g,{children:[e.jsx(n,{variant:"outline",onClick:()=>R(null),children:"Cancel"}),e.jsx(n,{variant:"destructive",onClick:()=>m&&ie(m),children:"Delete"})]})]})})]})}export{Re as default};
