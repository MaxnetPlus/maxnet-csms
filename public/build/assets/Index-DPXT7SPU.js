import{J as B,r as x,j as e,Q as L,t,S as c}from"./app-BYRtyPb_.js";import{B as w}from"./badge-BC2Zd0d0.js";import{c as M,B as a}from"./createLucideIcon-BpiIJ4rm.js";import{C as u,a as p,b as v,d as f,c as g}from"./card-BftSBUJ8.js";import{D as F}from"./data-table-7b_ZMsK3.js";import{D as S,b as _,c as k,d as U,e as I,f as R}from"./dialog-DR2gP9hk.js";import{I as O}from"./input-Coj9-rY9.js";import{A as Q}from"./app-layout-DmCh6ndE.js";import{H as V,R as q}from"./refresh-ccw-DTV1OCsl.js";import{M as J}from"./mail-CPFuqyqn.js";import{S as X}from"./search-BKK2UEjZ.js";import{X as G}from"./index-le9HfdOu.js";import{E as W}from"./eye-4WkWLZPN.js";import{P as Y}from"./pencil-CvufqGqh.js";import{T as Z}from"./trash-2-BaSbsQIs.js";import"./chevron-left-BMRaTl8q.js";import"./chevron-right-Dwz8_c5V.js";import"./index-BF6Sw6ge.js";import"./index-Cz1V6P9g.js";import"./index-D7g51E5Q.js";import"./app-logo-Bgq89sJX.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],se=M("Plus",ee);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],re=M("UserPlus",ae),ne=[{title:"Dashboard",href:"/dashboard"},{title:"User Management",href:"/admin/users"}];function Se({users:n,invitations:o,roles:A,filters:y}){var b;const{auth:j}=B().props,r=((b=j==null?void 0:j.user)==null?void 0:b.permissions)||[];console.log("User Permissions:",r);const[N,z]=x.useState(y.search||""),[C,T]=x.useState(y.role||""),[i,h]=x.useState(null),[l,m]=x.useState(null),E=s=>{s.preventDefault(),c.get("/admin/users",{search:N,role:C},{preserveState:!0,replace:!0})},H=s=>{c.delete(`/admin/users/${s.id}`,{onSuccess:()=>h(null)})},K=s=>{c.delete(`/admin/users/invitations/${s.id}`,{onSuccess:()=>m(null)})},P=s=>{c.post(`/admin/users/invitations/${s.id}/resend`)},$=[{header:"Name",accessorKey:"name",cell:s=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.email})]})},{header:"Roles",accessorKey:"roles",cell:s=>{var d;return e.jsx("div",{className:"flex flex-wrap gap-1",children:((d=s.roles)==null?void 0:d.map(D=>e.jsx(w,{variant:"secondary",children:D.name},D.id)))||e.jsx("span",{className:"text-muted-foreground",children:"No roles"})})}},{header:"Email Verified",accessorKey:"email_verified_at",cell:s=>e.jsx(w,{variant:s.email_verified_at?"default":"destructive",children:s.email_verified_at?"Verified":"Unverified"})},{header:"Created",accessorKey:"created_at",cell:s=>new Date(s.created_at).toLocaleDateString()},{header:"Actions",accessorKey:"id",cell:s=>r!=null&&r.includes("manage-users")?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(t,{href:`/admin/users/${s.id}`,children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(t,{href:`/admin/users/${s.id}/edit`,children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>h(s),className:"text-destructive hover:text-destructive",children:e.jsx(Z,{className:"h-4 w-4"})})]}):null}];return e.jsxs(Q,{breadcrumbs:ne,children:[e.jsx(L,{title:"User Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users and their permissions"})]}),(r==null?void 0:r.includes("manage-users"))&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(t,{href:"/admin/users/invitation-history",children:[e.jsx(V,{className:"mr-2 h-4 w-4"}),"Invitation History"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(t,{href:"/admin/users/invite",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Invite User"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(t,{href:"/admin/users/sso-pending",children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Pending SSO Users"]})}),e.jsx(a,{asChild:!0,children:e.jsxs(t,{href:"/admin/users/create",children:[e.jsx(se,{className:"mr-2 h-4 w-4"}),"Add User"]})})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(v,{children:"Filters"}),e.jsx(f,{children:"Filter users by search term and role"})]}),e.jsx(g,{children:e.jsxs("form",{onSubmit:E,className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(O,{placeholder:"Search by name or email...",value:N,onChange:s=>z(s.target.value)})}),e.jsx("div",{className:"w-48",children:e.jsxs("select",{value:C,onChange:s=>T(s.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"",children:"All Roles"}),A.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})}),e.jsxs(a,{type:"submit",children:[e.jsx(X,{className:"mr-2 h-4 w-4"}),"Search"]})]})})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Users (",n.total,")"]}),e.jsx(f,{children:"All users in the system"})]}),e.jsxs(g,{children:[e.jsx(F,{columns:$,data:n.data,searchKey:"name",searchPlaceholder:"Search users..."}),e.jsx("div",{className:"flex items-center justify-between space-x-2 py-4",children:e.jsxs("div",{className:"space-x-2",children:[n.prev_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>c.visit(n.prev_page_url),children:"Previous"}),n.next_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>c.visit(n.next_page_url),children:"Next"})]})})]})]}),o&&o.length>0&&(r==null?void 0:r.includes("manage-users"))&&e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Pending Invitations (",o.length,")"]}),e.jsx(f,{children:"Users who have been invited but haven't accepted yet"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-4",children:o.map(s=>{var d;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Role: ",s.role]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Invited by: ",(d=s.inviter)==null?void 0:d.name]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>P(s),title:"Resend invitation",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>m(s),className:"text-destructive hover:text-destructive",title:"Cancel invitation",children:e.jsx(G,{className:"h-4 w-4"})})]})]},s.id)})})})]})]}),e.jsx(S,{open:!!i,onOpenChange:()=>h(null),children:e.jsxs(_,{children:[e.jsxs(k,{children:[e.jsx(U,{children:"Delete User"}),e.jsxs(I,{children:["Are you sure you want to delete ",i==null?void 0:i.name,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>i&&H(i),children:"Delete"})]})]})}),e.jsx(S,{open:!!l,onOpenChange:()=>m(null),children:e.jsxs(_,{children:[e.jsxs(k,{children:[e.jsx(U,{children:"Cancel Invitation"}),e.jsxs(I,{children:["Are you sure you want to cancel the invitation for ",l==null?void 0:l.email,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>m(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>l&&K(l),children:"Cancel Invitation"})]})]})})]})}export{Se as default};
