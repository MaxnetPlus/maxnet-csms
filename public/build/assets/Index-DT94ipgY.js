import{J as L,r as x,j as e,Q as F,t as d,S as t}from"./app-CyvLo_kF.js";import{B as w}from"./badge-CJQFMs4o.js";import{c as M,B as a}from"./createLucideIcon-D-sjWZvW.js";import{C as u,a as p,b as v,d as f,c as g}from"./card-T-NU6bKg.js";import{D as P}from"./data-table-CMc4YHBv.js";import{D as _,b as S,c as k,d as I,e as U,f as R}from"./dialog-C8rs4ghM.js";import{I as O}from"./input-DikySJdn.js";import{A as Q,X as V}from"./app-layout-BOv98ebM.js";import{H as J,R as X}from"./refresh-ccw-DGio16yY.js";import{M as q}from"./mail-COcU2bdq.js";import{S as G}from"./search-BHNhz8g1.js";import{P as W}from"./pencil-BUF8dCRs.js";import{T as Y}from"./trash-2-CtoPi1do.js";import"./chevron-left-DzU6krFF.js";import"./chevron-right-BTx1AGsf.js";import"./index-BdX96gtP.js";import"./index-CNJMztRm.js";import"./app-logo-DEQ0MYgx.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],ee=M("Eye",Z);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ae=M("Plus",se),re=[{title:"Dashboard",href:"/dashboard"},{title:"User Management",href:"/admin/users"}];function Ce({users:n,invitations:o,roles:z,filters:N}){var b;const{auth:j}=L().props,r=((b=j==null?void 0:j.user)==null?void 0:b.permissions)||[];console.log("User Permissions:",r);const[y,A]=x.useState(N.search||""),[C,T]=x.useState(N.role||""),[l,h]=x.useState(null),[i,m]=x.useState(null),E=s=>{s.preventDefault(),t.get("/admin/users",{search:y,role:C},{preserveState:!0,replace:!0})},K=s=>{t.delete(`/admin/users/${s.id}`,{onSuccess:()=>h(null)})},$=s=>{t.delete(`/admin/users/invitations/${s.id}`,{onSuccess:()=>m(null)})},H=s=>{t.post(`/admin/users/invitations/${s.id}/resend`)},B=[{header:"Name",accessorKey:"name",cell:s=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.email})]})},{header:"Roles",accessorKey:"roles",cell:s=>{var c;return e.jsx("div",{className:"flex flex-wrap gap-1",children:((c=s.roles)==null?void 0:c.map(D=>e.jsx(w,{variant:"secondary",children:D.name},D.id)))||e.jsx("span",{className:"text-muted-foreground",children:"No roles"})})}},{header:"Email Verified",accessorKey:"email_verified_at",cell:s=>e.jsx(w,{variant:s.email_verified_at?"default":"destructive",children:s.email_verified_at?"Verified":"Unverified"})},{header:"Created",accessorKey:"created_at",cell:s=>new Date(s.created_at).toLocaleDateString()},{header:"Actions",accessorKey:"id",cell:s=>r!=null&&r.includes("manage-users")?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(d,{href:`/admin/users/${s.id}`,children:e.jsx(ee,{className:"h-4 w-4"})})}),e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(d,{href:`/admin/users/${s.id}/edit`,children:e.jsx(W,{className:"h-4 w-4"})})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>h(s),className:"text-destructive hover:text-destructive",children:e.jsx(Y,{className:"h-4 w-4"})})]}):null}];return e.jsxs(Q,{breadcrumbs:re,children:[e.jsx(F,{title:"User Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users and their permissions"})]}),(r==null?void 0:r.includes("manage-users"))&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(d,{href:"/admin/users/invitation-history",children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Invitation History"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(d,{href:"/admin/users/invite",children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Invite User"]})}),e.jsx(a,{asChild:!0,children:e.jsxs(d,{href:"/admin/users/create",children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Add User"]})})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(v,{children:"Filters"}),e.jsx(f,{children:"Filter users by search term and role"})]}),e.jsx(g,{children:e.jsxs("form",{onSubmit:E,className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(O,{placeholder:"Search by name or email...",value:y,onChange:s=>A(s.target.value)})}),e.jsx("div",{className:"w-48",children:e.jsxs("select",{value:C,onChange:s=>T(s.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"",children:"All Roles"}),z.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})}),e.jsxs(a,{type:"submit",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Search"]})]})})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Users (",n.total,")"]}),e.jsx(f,{children:"All users in the system"})]}),e.jsxs(g,{children:[e.jsx(P,{columns:B,data:n.data,searchKey:"name",searchPlaceholder:"Search users..."}),e.jsx("div",{className:"flex items-center justify-between space-x-2 py-4",children:e.jsxs("div",{className:"space-x-2",children:[n.prev_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>t.visit(n.prev_page_url),children:"Previous"}),n.next_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>t.visit(n.next_page_url),children:"Next"})]})})]})]}),o&&o.length>0&&(r==null?void 0:r.includes("manage-users"))&&e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Pending Invitations (",o.length,")"]}),e.jsx(f,{children:"Users who have been invited but haven't accepted yet"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-4",children:o.map(s=>{var c;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Role: ",s.role]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Invited by: ",(c=s.inviter)==null?void 0:c.name]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>H(s),title:"Resend invitation",children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>m(s),className:"text-destructive hover:text-destructive",title:"Cancel invitation",children:e.jsx(V,{className:"h-4 w-4"})})]})]},s.id)})})})]})]}),e.jsx(_,{open:!!l,onOpenChange:()=>h(null),children:e.jsxs(S,{children:[e.jsxs(k,{children:[e.jsx(I,{children:"Delete User"}),e.jsxs(U,{children:["Are you sure you want to delete ",l==null?void 0:l.name,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>l&&K(l),children:"Delete"})]})]})}),e.jsx(_,{open:!!i,onOpenChange:()=>m(null),children:e.jsxs(S,{children:[e.jsxs(k,{children:[e.jsx(I,{children:"Cancel Invitation"}),e.jsxs(U,{children:["Are you sure you want to cancel the invitation for ",i==null?void 0:i.email,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>m(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>i&&$(i),children:"Cancel Invitation"})]})]})})]})}export{Ce as default};
