import{j as e,r as c,Q as ge}from"./app-CyvLo_kF.js";import{c as E,a as V,b as fe,B as k}from"./createLucideIcon-D-sjWZvW.js";import{C as R,a as F,b as L,d as q,c as $}from"./card-T-NU6bKg.js";import{I as je}from"./input-DikySJdn.js";import{L as Y}from"./label-CyXuuwnD.js";import{c as be}from"./index-BdX96gtP.js";import{P as ie}from"./index-CNJMztRm.js";import{A as ve,D as Z,X as ee,F as B}from"./app-layout-BOv98ebM.js";import{C as se}from"./clock-CJvhbJkf.js";import"./app-logo-DEQ0MYgx.js";import"./chevron-right-BTx1AGsf.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],ye=E("CircleAlert",Ne);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ke=E("CircleCheckBig",we);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],te=E("TriangleAlert",Se);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],ae=E("Upload",Ce),Te=fe("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground border-border",destructive:"bg-destructive/10 text-destructive border-destructive/30 [&>svg]:text-destructive *:data-[slot=alert-description]:text-destructive/80",info:"bg-blue-50 text-blue-900 border-blue-200 dark:bg-blue-950 dark:text-blue-100 dark:border-blue-800 [&>svg]:text-blue-600 dark:[&>svg]:text-blue-400",warning:"bg-yellow-50 text-yellow-900 border-yellow-200 dark:bg-yellow-950 dark:text-yellow-100 dark:border-yellow-800 [&>svg]:text-yellow-600 dark:[&>svg]:text-yellow-400",success:"bg-green-50 text-green-900 border-green-200 dark:bg-green-950 dark:text-green-100 dark:border-green-800 [&>svg]:text-green-600 dark:[&>svg]:text-green-400",purple:"bg-purple-50 text-purple-900 border-purple-200 dark:bg-purple-950 dark:text-purple-100 dark:border-purple-800 [&>svg]:text-purple-600 dark:[&>svg]:text-purple-400"}},defaultVariants:{variant:"default"}});function Pe({className:t,variant:r,...g}){return e.jsx("div",{"data-slot":"alert",role:"alert",className:V(Te({variant:r}),t),...g})}function De({className:t,...r}){return e.jsx("div",{"data-slot":"alert-description",className:V("col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed opacity-90",t),...r})}var z="Progress",U=100,[Ie,We]=be(z),[Re,Fe]=Ie(z),ne=c.forwardRef((t,r)=>{const{__scopeProgress:g,value:p=null,max:a,getValueLabel:v=Le,...f}=t;(a||a===0)&&!re(a)&&console.error($e(`${a}`,"Progress"));const j=re(a)?a:U;p!==null&&!le(p,j)&&console.error(_e(`${p}`,"Progress"));const x=le(p,j)?p:null,y=_(x)?v(x,j):void 0;return e.jsx(Re,{scope:g,value:x,max:j,children:e.jsx(ie.div,{"aria-valuemax":j,"aria-valuemin":0,"aria-valuenow":_(x)?x:void 0,"aria-valuetext":y,role:"progressbar","data-state":de(x,j),"data-value":x??void 0,"data-max":j,...f,ref:r})})});ne.displayName=z;var oe="ProgressIndicator",ce=c.forwardRef((t,r)=>{const{__scopeProgress:g,...p}=t,a=Fe(oe,g);return e.jsx(ie.div,{"data-state":de(a.value,a.max),"data-value":a.value??void 0,"data-max":a.max,...p,ref:r})});ce.displayName=oe;function Le(t,r){return`${Math.round(t/r*100)}%`}function de(t,r){return t==null?"indeterminate":t===r?"complete":"loading"}function _(t){return typeof t=="number"}function re(t){return _(t)&&!isNaN(t)&&t>0}function le(t,r){return _(t)&&!isNaN(t)&&t<=r&&t>=0}function $e(t,r){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${U}\`.`}function _e(t,r){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${U} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ee=ne,Me=ce;function Ae({className:t,value:r,...g}){return e.jsx(Ee,{"data-slot":"progress",className:V("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...g,children:e.jsx(Me,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})})}const Oe=[{title:"Dashboard",href:"/dashboard"},{title:"Database Import",href:"/admin/database-import"}];function Ye(){var W;const[t,r]=c.useState(0),[g,p]=c.useState(""),[a,v]=c.useState(null),[f,j]=c.useState(null),[x,y]=c.useState(!1),[Q,S]=c.useState(null),[P,X]=c.useState(null),[J,u]=c.useState([]),[N,D]=c.useState(null),[M,K]=c.useState(!1),[C,G]=c.useState({customers:[],subscriptions:[]}),A=c.useRef(null),T=async()=>{var l;let s=(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.content;if(!s)try{const i=await fetch("/admin/database-import",{method:"GET",headers:{Accept:"text/html"}});if(i.ok){const d=(await i.text()).match(/<meta name="csrf-token" content="([^"]+)"/);if(d){s=d[1];const n=document.querySelector('meta[name="csrf-token"]');n&&(n.content=s)}}}catch(i){console.warn("Failed to refresh CSRF token:",i)}if(!s)throw new Error("CSRF token not found. Please refresh the page and try again.");return s},me=c.useCallback(s=>{var i,o;const l=(i=s.target.files)==null?void 0:i[0];if(l){if(((o=l.name.split(".").pop())==null?void 0:o.toLowerCase())!=="sql"){alert("Please select a valid SQL file (.sql extension required)"),s.target.value="";return}if(l.size>157286400){alert("File size must not exceed 150MB"),s.target.value="";return}j(l),v(null),r(0),p(""),S(null),u([])}},[]),H=c.useCallback(async(s,l)=>{try{K(!0);const i=await T(),o=await fetch("/admin/database-import/skipped-records",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":i,Accept:"application/json"},body:JSON.stringify({progress_id:s,type:l})});if(!o.ok)throw new Error("Failed to fetch skipped records");const d=await o.json();d.success&&G(n=>({...n,[l]:d.data||[]}))}catch(i){console.error("Error fetching skipped records:",i)}finally{K(!1)}},[T]),I=c.useCallback(async s=>{try{const l=await T(),i=await fetch("/admin/database-import/progress",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":l,Accept:"application/json"},body:JSON.stringify({progress_id:s})});if(!i.ok)throw new Error("Failed to fetch progress");const o=await i.json(),d=Math.max(0,Math.min(100,o.percentage));r(d),p(o.message),u(n=>{const m=`${new Date().toLocaleTimeString()}: ${o.message}`,w=n[n.length-1],b=w?w.split(": ").slice(1).join(": "):"";return o.message!==b?[...n,m]:n}),o.percentage>=0&&o.percentage<100?setTimeout(()=>I(s),1e3):o.percentage===100?(u(n=>[...n,`${new Date().toLocaleTimeString()}: Fetching final results...`]),setTimeout(async()=>{try{let n=3,h=0,m=null;for(;h<n;){h++,u(b=>[...b,`${new Date().toLocaleTimeString()}: Fetching final results (attempt ${h}/${n})...`]);const w=await fetch("/admin/database-import/results",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":l,Accept:"application/json"},body:JSON.stringify({progress_id:s})});if(console.log(`Results API response status (attempt ${h}):`,w.status),w.ok&&(m=await w.json(),console.log(`Results response (attempt ${h}):`,m),m.success&&m.data)){console.log("Setting result to:",m.data),v(m.data),u(b=>[...b,`${new Date().toLocaleTimeString()}: Results retrieved successfully!`]);break}if(h<n){const b=h*2e3;u(O=>[...O,`${new Date().toLocaleTimeString()}: Results not ready, waiting ${b/1e3} seconds...`]),await new Promise(O=>setTimeout(O,b))}}(!(m!=null&&m.success)||!(m!=null&&m.data))&&(console.log("Results not available after multiple attempts, using placeholder"),u(b=>[...b,`${new Date().toLocaleTimeString()}: Warning: Results not available after multiple attempts`]),v({progress_id:s,customers:{imported:0,skipped:0,total:0},subscriptions:{imported:0,skipped:0,total:0}}))}catch(n){console.error("Failed to fetch results:",n),u(m=>[...m,`${new Date().toLocaleTimeString()}: Warning: Could not fetch detailed results`]),console.log("Creating placeholder result due to exception"),v({progress_id:s,customers:{imported:0,skipped:0,total:0},subscriptions:{imported:0,skipped:0,total:0}})}y(!1),console.log("Import process completed, uploading set to false, progress:",o.percentage)},2e3)):o.percentage<0&&(S(o.message),y(!1))}catch(l){console.error("Progress tracking error:",l),s&&setTimeout(()=>I(s),2e3)}},[T]),pe=c.useCallback(async()=>{if(f){y(!0),console.log("Starting upload process, uploading set to true"),r(0),p("Starting import..."),v(null),S(null),u([`${new Date().toLocaleTimeString()}: Import started...`]);try{const s=new FormData;s.append("sql_file",f);const l=await T();r(5),p("Uploading file..."),u(n=>[...n,`${new Date().toLocaleTimeString()}: Uploading SQL file...`]);const i=await fetch("/admin/database-import/upload",{method:"POST",headers:{"X-CSRF-TOKEN":l,Accept:"application/json"},body:s}),o=i.clone();let d;try{d=await i.json()}catch{const h=await o.text();throw console.error("Failed to parse JSON response:",h),i.status===419?new Error("Session expired. Please refresh the page and try again."):i.status===403?new Error("Access denied. You may not have permission to import databases."):i.status===422?new Error("Validation failed. Please check your file and try again."):new Error(`Server returned invalid JSON response. Status: ${i.status}. Please check the server logs for more details.`)}if(i.ok&&d.success)d.data.progress_id?(X(d.data.progress_id),u(n=>[...n,`${new Date().toLocaleTimeString()}: File uploaded successfully, starting import process...`]),await I(d.data.progress_id)):(v(d.data),r(100),p("Import completed successfully!"),u(n=>[...n,`${new Date().toLocaleTimeString()}: Import completed successfully!`]),y(!1));else throw new Error(d.message||"Import failed")}catch(s){const l=s.message||"Import failed";S(l),r(0),p("Import failed"),u(i=>[...i,`${new Date().toLocaleTimeString()}: Error - ${l}`]),y(!1)}}},[f,I]),ue=c.useCallback(()=>{j(null),y(!1),r(0),p(""),v(null),S(null),X(null),u([]),D(null),G({customers:[],subscriptions:[]}),A.current&&(clearInterval(A.current),A.current=null);const s=document.getElementById("sql-file");s&&(s.value="")},[]),xe=s=>{if(s===0)return"0 Bytes";const l=1024,i=["Bytes","KB","MB","GB"],o=Math.floor(Math.log(s)/Math.log(l));return parseFloat((s/Math.pow(l,o)).toFixed(2))+" "+i[o]},he=()=>{window.location.href="/admin/reports"};return c.useEffect(()=>{console.log("Result state changed:",a)},[a]),e.jsxs(ve,{breadcrumbs:Oe,children:[e.jsx(ge,{title:"Database Import"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Database Import"}),e.jsx("p",{className:"text-muted-foreground",children:"Import customers and subscriptions from SQL file"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(R,{children:[e.jsxs(F,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"Upload SQL File"]}),e.jsx(q,{children:"Select a SQL file containing customers and subscriptions data (max 150MB)"})]}),e.jsxs($,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"sql-file",children:"SQL File"}),e.jsx(je,{id:"sql-file",type:"file",accept:".sql",onChange:me,disabled:x}),f&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Selected: ",f.name," (",xe(f.size),")"]})]}),Q&&e.jsxs(Pe,{variant:"destructive",className:"dark:border-red-800 dark:bg-red-900 dark:text-red-100",children:[e.jsx(ye,{className:"h-4 w-4 dark:text-red-300"}),e.jsx(De,{className:"dark:text-red-100",children:Q})]}),x&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"font-medium",children:"Import Progress"}),e.jsxs("span",{className:"font-medium",children:[t,"%"]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Ae,{value:t,className:`h-3 w-full ${t<0?"bg-red-100":t<40?"bg-blue-100":t<70?"bg-green-100":t<100?"bg-purple-100":"bg-emerald-100"}`}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsx("span",{className:t>=10?"text-green-600":"",children:"Parse File"}),e.jsx("span",{className:t>=40?"text-green-600":"",children:"Import Customers"}),e.jsx("span",{className:t>=70?"text-green-600":"",children:"Import Subscriptions"}),e.jsx("span",{className:t>=100?"text-green-600":"",children:"Complete"})]})]}),g&&e.jsxs("div",{className:"flex items-center gap-2 rounded bg-blue-50 p-2 text-sm",children:[e.jsx(se,{className:"h-4 w-4 flex-shrink-0 text-blue-600"}),e.jsx("span",{className:"text-blue-800",children:g})]})]}),J.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs(Y,{className:"flex items-center gap-2 text-sm font-medium",children:[e.jsx(se,{className:"h-4 w-4"}),"Import Activity Log"]}),e.jsxs("div",{className:"max-h-40 space-y-1 overflow-y-auto rounded-md border bg-muted/30 p-3",children:[J.map((s,l)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsxs("span",{className:"flex-shrink-0 font-mono text-blue-600",children:[s.split(": ")[0],":"]}),e.jsx("span",{className:"text-muted-foreground",children:s.split(": ").slice(1).join(": ")})]},l)),e.jsx("div",{ref:s=>s==null?void 0:s.scrollIntoView({behavior:"smooth"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(k,{onClick:pe,disabled:!f||x,className:"flex-1",children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),x?"Importing...":"Start Import"]}),(f||a)&&e.jsxs(k,{variant:"outline",onClick:ue,disabled:x,children:[e.jsx(ee,{className:"mr-2 h-4 w-4"}),"Reset"]})]})]})]}),e.jsxs(R,{children:[e.jsx(F,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5"}),"Panduan Impor"]})}),e.jsxs($,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2 font-medium",children:"Persyaratan File"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"• Format file SQL (.sql)"}),e.jsx("li",{children:"• Ukuran file maksimum: 150MB"}),e.jsx("li",{children:"• Harus berisi perintah INSERT"}),e.jsx("li",{children:"• Disarankan menggunakan encoding UTF-8"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2 font-medium",children:"Tabel yang Diharapkan"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsxs("li",{children:["• ",e.jsx("code",{children:"customers"})," - Data master pelanggan"]}),e.jsxs("li",{children:["• ",e.jsx("code",{children:"subscriptions"})," - Data langganan"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2 font-medium",children:"Proses Import"}),e.jsxs("ul",{className:"space-y-1 text-sm text-muted-foreground",children:[e.jsx("li",{children:"• Pelanggan diimpor terlebih dahulu"}),e.jsx("li",{children:"• Langganan akan dikaitkan ke pelanggan"}),e.jsx("li",{children:"• Data duplikat akan diperbarui"}),e.jsx("li",{children:"• Data tidak valid akan dilewati"})]})]})]})]})]}),a&&e.jsxs(R,{children:[e.jsxs(F,{children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ke,{className:"h-5 w-5 text-green-600"}),"Import Results"]}),e.jsxs(q,{children:["Import completed at ",new Date().toLocaleString()]})]}),e.jsxs($,{children:[e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-blue-600"}),e.jsx("h4",{className:"font-medium",children:"Customers"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total records found:"}),e.jsx("span",{className:"font-medium",children:a.customers.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Successfully imported:"}),e.jsx("span",{className:"font-medium text-green-600",children:a.customers.imported})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Skipped/Failed:"}),e.jsx("span",{className:"font-medium text-yellow-600",children:a.customers.skipped})]}),e.jsx("div",{className:"mt-2 border-t pt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Success Rate:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[a.customers.total>0?Math.round(a.customers.imported/a.customers.total*100):0,"%"]})]})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"h-5 w-5 text-purple-600"}),e.jsx("h4",{className:"font-medium",children:"Subscriptions"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total records found:"}),e.jsx("span",{className:"font-medium",children:a.subscriptions.total})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Successfully imported:"}),e.jsx("span",{className:"font-medium text-green-600",children:a.subscriptions.imported})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Skipped/Failed:"}),e.jsx("span",{className:"font-medium text-yellow-600",children:a.subscriptions.skipped})]}),e.jsx("div",{className:"mt-2 border-t pt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Success Rate:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[a.subscriptions.total>0?Math.round(a.subscriptions.imported/a.subscriptions.total*100):0,"%"]})]})})]})]})]}),(a.customers.skipped>0||a.subscriptions.skipped>0)&&e.jsx("div",{className:"mt-6 rounded-lg border border-yellow-200 bg-yellow-50 p-4",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(te,{className:"mt-0.5 h-5 w-5 text-yellow-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-yellow-800",children:"Some records were skipped"}),e.jsx("p",{className:"mt-1 text-sm text-yellow-700",children:"Records may have been skipped due to:"}),e.jsxs("ul",{className:"mt-2 space-y-1 text-sm text-yellow-700",children:[e.jsx("li",{children:"• Invalid customer references"}),e.jsx("li",{children:"• Data validation errors"}),e.jsx("li",{children:"• Database constraint violations"}),e.jsx("li",{children:"• Duplicate IDs"})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[a.customers.skipped>0&&e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>{D("customers"),P&&C.customers.length===0&&H(P,"customers")},disabled:M,className:"border-yellow-300 text-yellow-800 hover:bg-yellow-100",children:["View Skipped Customers (",a.customers.skipped,")"]}),a.subscriptions.skipped>0&&e.jsxs(k,{variant:"outline",size:"sm",onClick:()=>{D("subscriptions"),P&&C.subscriptions.length===0&&H(P,"subscriptions")},disabled:M,className:"border-yellow-300 text-yellow-800 hover:bg-yellow-100",children:["View Skipped Subscriptions (",a.subscriptions.skipped,")"]})]})]})]})}),e.jsxs("div",{className:"mt-6 flex justify-center gap-3",children:[e.jsxs(k,{onClick:he,children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"View Reports"]}),e.jsxs(k,{variant:"outline",onClick:()=>window.location.reload(),children:[e.jsx(ae,{className:"mr-2 h-4 w-4"}),"Import Another File"]})]})]})]}),N&&e.jsxs(R,{className:"mt-6",children:[e.jsxs(F,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5 text-yellow-600"}),"Skipped ",N==="customers"?"Customers":"Subscriptions"," Details"]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:()=>D(null),className:"h-8 w-8 p-0",children:e.jsx(ee,{className:"h-4 w-4"})})]}),e.jsx(q,{children:"Details of records that were skipped during import with reasons"})]}),e.jsx($,{children:M?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading skipped records..."})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing skipped ",N," records (",C[N].length," of"," ",((W=a==null?void 0:a[N])==null?void 0:W.skipped)||0," total)"]}),C[N].length>0?e.jsx("div",{className:"max-h-96 space-y-3 overflow-y-auto",children:C[N].map((s,l)=>e.jsxs("div",{className:"rounded-lg border border-red-200 bg-red-50 p-3",children:[e.jsxs("div",{className:"mb-2 flex items-start justify-between",children:[e.jsx("div",{className:"font-medium text-red-800",children:N==="customers"?e.jsxs(e.Fragment,{children:["Customer: ",s.customer_name||s.customer_id]}):e.jsxs(e.Fragment,{children:["Subscription: ",s.subscription_id]})}),e.jsx("span",{className:"rounded bg-red-100 px-2 py-1 text-xs text-red-700",children:s.reason})]}),e.jsxs("div",{className:"text-sm text-red-700",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Customer ID:"})," ",s.customer_id]}),s.subscription_id&&e.jsxs("div",{children:[e.jsx("strong",{children:"Subscription ID:"})," ",s.subscription_id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Details:"})," ",s.details]})]})]},l))}):e.jsxs("div",{className:"p-8 text-center text-muted-foreground",children:["No detailed records available for skipped ",N]})]})})]})]})]})}export{Ye as default};
