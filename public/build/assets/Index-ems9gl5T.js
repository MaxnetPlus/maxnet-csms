import{J as L,r as x,j as e,Q,t as i,S as c}from"./app-Ci8v6MrU.js";import{B as S}from"./badge-BIBJLQYD.js";import{B as a}from"./createLucideIcon-D00yv57C.js";import{C as u,a as p,b as v,d as f,c as g}from"./card-ByE5s6QK.js";import{D as V}from"./data-table-ND9nM1DW.js";import{D,a as U,b as _,c as I,d as k,e as R}from"./dialog-CLW4o-7o.js";import{I as J}from"./input-DnuT7wtE.js";import{A as X}from"./app-layout-Bk_jRNVy.js";import{H as A,R as q}from"./refresh-ccw-CPYosw5h.js";import{M as z}from"./mail-D9hoTAtf.js";import{U as T}from"./user-plus-DPX4hucb.js";import{P as E}from"./plus-BwkWnYw8.js";import{S as G}from"./search-D6KFkx-7.js";import{X as W}from"./index-Rg3zaoIu.js";import{E as Y}from"./eye-BL1W-KhU.js";import{P as Z}from"./pencil-BiH6ZTe5.js";import{T as ee}from"./trash-2-DGME01fH.js";import"./table-Ddueo_gH.js";import"./chevron-left-DmyxnLB3.js";import"./chevron-right-CupTmoq7.js";import"./index-CBB6N_tQ.js";import"./index-de0Lxc7d.js";import"./index-CWMKBz9E.js";import"./index-DDGoCjQ0.js";import"./breadcrumbs-dv4TgKDm.js";import"./app-logo-B3Gf4bRh.js";import"./index-CjJcgxXh.js";import"./index-SNZ2oUW7.js";import"./index-cyYLnq4n.js";import"./chevron-down-Du86AyeO.js";import"./file-text-BUANXoVS.js";import"./trending-up-wTNNJME6.js";import"./target-Cx7wIY1u.js";const se=[{title:"Dashboard",href:"/dashboard"},{title:"User Management",href:"/admin/users"}];function Ee({users:n,invitations:o,roles:H,filters:N}){var w;const{auth:j}=L().props,r=((w=j==null?void 0:j.user)==null?void 0:w.permissions)||[];console.log("User Permissions:",r);const[C,K]=x.useState(N.search||""),[y,M]=x.useState(N.role||""),[l,h]=x.useState(null),[t,m]=x.useState(null),P=s=>{s.preventDefault(),c.get("/admin/users",{search:C,role:y},{preserveState:!0,replace:!0})},$=s=>{c.delete(`/admin/users/${s.id}`,{onSuccess:()=>h(null)})},B=s=>{c.delete(`/admin/users/invitations/${s.id}`,{onSuccess:()=>m(null)})},F=s=>{c.post(`/admin/users/invitations/${s.id}/resend`)},O=[{header:"Name",accessorKey:"name",cell:s=>e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.email})]})},{header:"Roles",accessorKey:"roles",cell:s=>{var d;return e.jsx("div",{className:"flex flex-wrap gap-1",children:((d=s.roles)==null?void 0:d.map(b=>e.jsx(S,{variant:"secondary",children:b.name},b.id)))||e.jsx("span",{className:"text-muted-foreground",children:"No roles"})})}},{header:"Email Verified",accessorKey:"email_verified_at",cell:s=>e.jsx(S,{variant:s.email_verified_at?"default":"destructive",children:s.email_verified_at?"Verified":"Unverified"})},{header:"Created",accessorKey:"created_at",cell:s=>new Date(s.created_at).toLocaleDateString()},{header:"Actions",accessorKey:"id",cell:s=>r!=null&&r.includes("manage-users")?e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(i,{href:`/admin/users/${s.id}`,children:e.jsx(Y,{className:"h-4 w-4"})})}),e.jsx(a,{asChild:!0,variant:"ghost",size:"sm",children:e.jsx(i,{href:`/admin/users/${s.id}/edit`,children:e.jsx(Z,{className:"h-4 w-4"})})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>h(s),className:"text-destructive hover:text-destructive",children:e.jsx(ee,{className:"h-4 w-4"})})]}):null}];return e.jsxs(X,{breadcrumbs:se,children:[e.jsx(Q,{title:"User Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage users and their permissions"})]}),(r==null?void 0:r.includes("manage-users"))&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"hidden gap-2 md:flex",children:[e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(i,{href:"/admin/users/invitation-history",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Invitation History"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(i,{href:"/admin/users/invite",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Invite User"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(i,{href:"/admin/users/sso-pending",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Pending SSO Users"]})}),e.jsx(a,{asChild:!0,children:e.jsxs(i,{href:"/admin/users/create",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Add User"]})})]}),e.jsxs("div",{className:"mt-2 flex flex-col gap-2 md:hidden",children:[e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(i,{href:"/admin/users/invitation-history",children:[e.jsx(A,{className:"mr-2 h-4 w-4"}),"Invitation History"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(i,{href:"/admin/users/invite",children:[e.jsx(z,{className:"mr-2 h-4 w-4"}),"Invite User"]})}),e.jsx(a,{asChild:!0,variant:"outline",children:e.jsxs(i,{href:"/admin/users/sso-pending",children:[e.jsx(T,{className:"mr-2 h-4 w-4"}),"Pending SSO Users"]})}),e.jsx(a,{asChild:!0,children:e.jsxs(i,{href:"/admin/users/create",children:[e.jsx(E,{className:"mr-2 h-4 w-4"}),"Add User"]})})]})]})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsx(v,{children:"Filters"}),e.jsx(f,{children:"Filter users by search term and role"})]}),e.jsx(g,{children:e.jsxs("form",{onSubmit:P,className:"flex gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(J,{placeholder:"Search by name or email...",value:C,onChange:s=>K(s.target.value)})}),e.jsx("div",{className:"w-48",children:e.jsxs("select",{value:y,onChange:s=>M(s.target.value),className:"w-full rounded-md border border-input bg-background px-3 py-2",children:[e.jsx("option",{value:"",children:"All Roles"}),H.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})}),e.jsxs(a,{type:"submit",children:[e.jsx(G,{className:"mr-2 h-4 w-4"}),"Search"]})]})})]}),e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Users (",n.total,")"]}),e.jsx(f,{children:"All users in the system"})]}),e.jsxs(g,{children:[e.jsx(V,{columns:O,data:n.data,searchKey:"name",searchPlaceholder:"Search users..."}),e.jsx("div",{className:"flex items-center justify-between space-x-2 py-4",children:e.jsxs("div",{className:"space-x-2",children:[n.prev_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>c.visit(n.prev_page_url),children:"Previous"}),n.next_page_url&&e.jsx(a,{variant:"outline",size:"sm",onClick:()=>c.visit(n.next_page_url),children:"Next"})]})})]})]}),o&&o.length>0&&(r==null?void 0:r.includes("manage-users"))&&e.jsxs(u,{children:[e.jsxs(p,{children:[e.jsxs(v,{children:["Pending Invitations (",o.length,")"]}),e.jsx(f,{children:"Users who have been invited but haven't accepted yet"})]}),e.jsx(g,{children:e.jsx("div",{className:"space-y-4",children:o.map(s=>{var d;return e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.email}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsxs("span",{children:["Role: ",s.role]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Invited by: ",(d=s.inviter)==null?void 0:d.name]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Expires: ",new Date(s.expires_at).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>F(s),title:"Resend invitation",children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(a,{variant:"ghost",size:"sm",onClick:()=>m(s),className:"text-destructive hover:text-destructive",title:"Cancel invitation",children:e.jsx(W,{className:"h-4 w-4"})})]})]},s.id)})})})]})]}),e.jsx(D,{open:!!l,onOpenChange:()=>h(null),children:e.jsxs(U,{children:[e.jsxs(_,{children:[e.jsx(I,{children:"Delete User"}),e.jsxs(k,{children:["Are you sure you want to delete ",l==null?void 0:l.name,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>h(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>l&&$(l),children:"Delete"})]})]})}),e.jsx(D,{open:!!t,onOpenChange:()=>m(null),children:e.jsxs(U,{children:[e.jsxs(_,{children:[e.jsx(I,{children:"Cancel Invitation"}),e.jsxs(k,{children:["Are you sure you want to cancel the invitation for ",t==null?void 0:t.email,"? This action cannot be undone."]})]}),e.jsxs(R,{children:[e.jsx(a,{variant:"outline",onClick:()=>m(null),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:()=>t&&B(t),children:"Cancel Invitation"})]})]})})]})}export{Ee as default};
